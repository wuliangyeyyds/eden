{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'AiAssistantLite',\n  props: {\n    userId: {\n      type: [Number, String],\n      default: null\n    }\n  },\n  data() {\n    return {\n      // drawer\n      drawerVisible: false,\n      // chat\n      inputText: '',\n      sending: false,\n      conversationId: '',\n      messages: [],\n      // quick prompts\n      showQuick: true,\n      quickQuestions: ['ÊÄé‰πàÈ¢ÑÁ∫¶Â∫ß‰ΩçÔºü', 'Êàë‰ªäÂ§©ÊúâÂì™‰∫õÈ¢ÑÁ∫¶Ôºü', '‰∏∫‰ªÄ‰πàÊàëÂèòÊàêÈ¢ÑË≠¶/ÈªëÂêçÂçïÔºü', 'Â¶Ç‰ΩïÁ≠æÂà∞/Á≠æÈÄÄÔºü'],\n      // floating ball drag\n      floatX: null,\n      floatY: null,\n      dragging: false,\n      longPressTimer: null,\n      longPressMs: 260,\n      startClientX: 0,\n      startClientY: 0,\n      startFloatX: 0,\n      startFloatY: 0,\n      pointerId: null,\n      hasUnreadHint: false\n    };\n  },\n  computed: {\n    resolvedUserId() {\n      const p = this.userId;\n      if (p !== null && p !== undefined && String(p).trim() !== '') return Number(p);\n      try {\n        const raw = localStorage.getItem('ssrmsUser') || sessionStorage.getItem('ssrmsUser');\n        if (!raw) return null;\n        const u = JSON.parse(raw);\n        const id = u.userId ?? u.id ?? null;\n        return id === null ? null : Number(id);\n      } catch (e) {\n        return null;\n      }\n    },\n    storageKey() {\n      return `ssrms_ai_lite_${this.resolvedUserId ?? 'guest'}`;\n    },\n    floatPosKey() {\n      return `ssrms_ai_float_pos_${this.resolvedUserId ?? 'guest'}`;\n    },\n    floatStyle() {\n      const x = this.floatX === null || this.floatX === undefined ? window.innerWidth - 18 - 56 : this.floatX;\n      const y = this.floatY === null || this.floatY === undefined ? window.innerHeight - 18 - 56 : this.floatY;\n      return {\n        left: `${x}px`,\n        top: `${y}px`\n      };\n    }\n  },\n  mounted() {\n    this.loadFromStorage();\n    this.restoreFloatPos();\n    window.addEventListener('resize', this.clampFloatToViewport);\n  },\n  beforeUnmount() {\n    window.removeEventListener('resize', this.clampFloatToViewport);\n  },\n  watch: {\n    drawerVisible(v) {\n      if (v) {\n        this.hasUnreadHint = false;\n        this.$nextTick(() => this.scrollToBottom());\n      }\n    }\n  },\n  methods: {\n    // ---------- ÊÇ¨ÊµÆÁêÉÊãñÂä® ----------\n    restoreFloatPos() {\n      try {\n        const raw = localStorage.getItem(this.floatPosKey);\n        if (!raw) return;\n        const obj = JSON.parse(raw);\n        if (typeof obj.x === 'number' && typeof obj.y === 'number') {\n          this.floatX = obj.x;\n          this.floatY = obj.y;\n          this.clampFloatToViewport();\n        }\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩ‰∏çÂèØÁî®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    saveFloatPos() {\n      try {\n        localStorage.setItem(this.floatPosKey, JSON.stringify({\n          x: this.floatX,\n          y: this.floatY\n        }));\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩ‰∏çÂèØÁî®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    clampFloatToViewport() {\n      const size = 56;\n      const pad = 8;\n      const maxX = Math.max(pad, window.innerWidth - size - pad);\n      const maxY = Math.max(pad, window.innerHeight - size - pad);\n      if (this.floatX === null || this.floatX === undefined) this.floatX = maxX;\n      if (this.floatY === null || this.floatY === undefined) this.floatY = maxY;\n      this.floatX = Math.min(Math.max(this.floatX, pad), maxX);\n      this.floatY = Math.min(Math.max(this.floatY, pad), maxY);\n    },\n    onPointerDown(e) {\n      if (e.button !== undefined && e.button !== 0) return;\n      this.pointerId = e.pointerId;\n      this.startClientX = e.clientX;\n      this.startClientY = e.clientY;\n      const rect = e.currentTarget.getBoundingClientRect();\n      this.startFloatX = rect.left;\n      this.startFloatY = rect.top;\n      this.longPressTimer = setTimeout(() => {\n        this.dragging = true;\n        this.hasUnreadHint = false;\n        try {\n          e.currentTarget.setPointerCapture(this.pointerId);\n        } catch (err) {\n          // ÈÉ®ÂàÜÊµèËßàÂô®‰∏çÊîØÊåÅ captureÔºåÂøΩÁï•Âç≥ÂèØ\n        }\n      }, this.longPressMs);\n    },\n    onPointerMove(e) {\n      if (this.pointerId === null || e.pointerId !== this.pointerId) return;\n      const dx0 = e.clientX - this.startClientX;\n      const dy0 = e.clientY - this.startClientY;\n      const movedFar = Math.hypot(dx0, dy0) > 10;\n      if (!this.dragging && movedFar && this.longPressTimer) {\n        clearTimeout(this.longPressTimer);\n        this.longPressTimer = null;\n        this.dragging = true;\n      }\n      if (!this.dragging) return;\n      const dx = e.clientX - this.startClientX;\n      const dy = e.clientY - this.startClientY;\n      this.floatX = this.startFloatX + dx;\n      this.floatY = this.startFloatY + dy;\n      this.clampFloatToViewport();\n    },\n    onPointerUp() {\n      if (this.longPressTimer) {\n        clearTimeout(this.longPressTimer);\n        this.longPressTimer = null;\n      }\n      if (this.dragging) {\n        this.dragging = false;\n        this.pointerId = null;\n        this.saveFloatPos();\n        return;\n      }\n      this.pointerId = null;\n      this.openDrawer();\n    },\n    // ---------- ËÅäÂ§© ----------\n    openDrawer() {\n      this.drawerVisible = true;\n      this.loadFromStorage();\n      this.$nextTick(() => this.scrollToBottom());\n    },\n    loadFromStorage() {\n      try {\n        const raw = localStorage.getItem(this.storageKey);\n        if (!raw) {\n          this.messages = [];\n          this.conversationId = '';\n          return;\n        }\n        const obj = JSON.parse(raw);\n        this.messages = Array.isArray(obj.messages) ? obj.messages : [];\n        this.conversationId = obj.conversationId || '';\n      } catch (e) {\n        this.messages = [];\n        this.conversationId = '';\n      }\n    },\n    saveToStorage() {\n      try {\n        localStorage.setItem(this.storageKey, JSON.stringify({\n          conversationId: this.conversationId || '',\n          messages: this.messages || []\n        }));\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩË¢´Á¶ÅÁî®/Á©∫Èó¥‰∏çË∂≥ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    clearChat() {\n      this.messages = [];\n      this.conversationId = '';\n      this.saveToStorage();\n      ElMessage.success('Â∑≤Ê∏ÖÁ©∫ÂØπËØù');\n      this.$nextTick(() => this.scrollToBottom());\n    },\n    useQuick(q) {\n      if (this.sending) return;\n      this.inputText = q;\n      this.$nextTick(() => this.send());\n    },\n    pushMsg(role, text) {\n      const msg = {\n        id: `${Date.now()}_${Math.random().toString(16).slice(2)}`,\n        role,\n        text: String(text ?? ''),\n        ts: Date.now()\n      };\n      this.messages.push(msg);\n      this.saveToStorage();\n      this.$nextTick(() => this.scrollToBottom());\n    },\n    formatTime(ts) {\n      try {\n        const d = new Date(ts);\n        const hh = String(d.getHours()).padStart(2, '0');\n        const mm = String(d.getMinutes()).padStart(2, '0');\n        return `${hh}:${mm}`;\n      } catch (e) {\n        return '';\n      }\n    },\n    scrollToBottom() {\n      try {\n        const el = this.$el.querySelector('.ai-body .el-scrollbar__wrap');\n        if (el) el.scrollTop = el.scrollHeight;\n      } catch (e) {\n        // DOM ÂÆπÂô®ÂèØËÉΩÊöÇÊú™Ê∏≤ÊüìÊàñ‰∏çÂ≠òÂú®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    async send() {\n      const text = this.inputText.trim();\n      if (!text || this.sending) return;\n      if (!this.resolvedUserId) {\n        ElMessage.warning('Êú™Ëé∑ÂèñÂà∞Áî®Êà∑‰ø°ÊÅØÔºåËØ∑ÂÖàÁôªÂΩïÂêéÂÜç‰ΩøÁî® AI Âä©Êâã');\n        return;\n      }\n      this.pushMsg('user', text);\n      this.inputText = '';\n      this.sending = true;\n      try {\n        const payload = {\n          userId: this.resolvedUserId,\n          message: text,\n          conversationId: this.conversationId || null\n        };\n\n        // ÂÖºÂÆπÔºö‰Ω†ÁöÑ request.js ÂèØËÉΩÂ∑≤Áªè return response.data\n        const res = await this.$axios.post('/ai/chat', payload);\n        const body = res && typeof res.code !== 'undefined' ? res : res && res.data ? res.data : null;\n        if (!body || Number(body.code) !== 200) {\n          const msg = body && (body.msg || body.message) ? body.msg || body.message : 'AI ËØ∑Ê±ÇÂ§±Ë¥•';\n          throw new Error(msg);\n        }\n        const data = body.data || {};\n        if (data.conversationId) this.conversationId = data.conversationId;\n        this.pushMsg('assistant', data.reply || 'ÔºàAI Êú™ËøîÂõûÂÜÖÂÆπÔºâ');\n      } catch (e) {\n        this.pushMsg('assistant', `ÔºàÂá∫Èîô‰∫ÜÔºâ${e?.message || 'AI ËØ∑Ê±ÇÂ§±Ë¥•'}`);\n      } finally {\n        this.sending = false;\n        this.saveToStorage();\n        this.$nextTick(() => this.scrollToBottom());\n      }\n    }\n  }\n};","map":{"version":3,"names":["ElMessage","name","props","userId","type","Number","String","default","data","drawerVisible","inputText","sending","conversationId","messages","showQuick","quickQuestions","floatX","floatY","dragging","longPressTimer","longPressMs","startClientX","startClientY","startFloatX","startFloatY","pointerId","hasUnreadHint","computed","resolvedUserId","p","undefined","trim","raw","localStorage","getItem","sessionStorage","u","JSON","parse","id","e","storageKey","floatPosKey","floatStyle","x","window","innerWidth","y","innerHeight","left","top","mounted","loadFromStorage","restoreFloatPos","addEventListener","clampFloatToViewport","beforeUnmount","removeEventListener","watch","v","$nextTick","scrollToBottom","methods","obj","saveFloatPos","setItem","stringify","size","pad","maxX","Math","max","maxY","min","onPointerDown","button","clientX","clientY","rect","currentTarget","getBoundingClientRect","setTimeout","setPointerCapture","err","onPointerMove","dx0","dy0","movedFar","hypot","clearTimeout","dx","dy","onPointerUp","openDrawer","Array","isArray","saveToStorage","clearChat","success","useQuick","q","send","pushMsg","role","text","msg","Date","now","random","toString","slice","ts","push","formatTime","d","hh","getHours","padStart","mm","getMinutes","el","$el","querySelector","scrollTop","scrollHeight","warning","payload","message","res","$axios","post","body","code","Error","reply"],"sources":["D:\\code\\SpringBoot-Vue-SSRMS\\ssrms-web\\src\\components\\AiAssistantLite.vue"],"sourcesContent":["<template>\n  <div class=\"ai-lite-root\">\n    <!-- ÊÇ¨ÊµÆÁêÉÔºöÈïøÊåâÊãñÂä®ÔºõÁÇπÂáªÊâìÂºÄ -->\n    <div\n        v-show=\"!drawerVisible\"\n        class=\"ai-float\"\n        :style=\"floatStyle\"\n        @pointerdown=\"onPointerDown\"\n        @pointermove=\"onPointerMove\"\n        @pointerup=\"onPointerUp\"\n        @pointercancel=\"onPointerUp\"\n    >\n      <div class=\"ai-float-inner\" :class=\"{ dragging: dragging }\" title=\"AI Ëá™‰π†ÂÆ§Âä©ÊâãÔºàÈïøÊåâÊãñÂä®Ôºâ\">\n        <div class=\"ai-float-emoji\">ü§ñ</div>\n        <div class=\"ai-float-dot\" v-if=\"hasUnreadHint\"></div>\n      </div>\n    </div>\n\n    <!-- ÊäΩÂ±âËÅäÂ§©Á™óÔºö‰ºöË¶ÜÁõñÈ°µÈù¢ÔºàÊÇ¨ÊµÆÁêÉÂêåÊó∂ÈöêËóèÔºâ -->\n    <el-drawer\n        v-model=\"drawerVisible\"\n        :with-header=\"false\"\n        size=\"440px\"\n        class=\"ai-drawer\"\n        :append-to-body=\"true\"\n        :modal=\"true\"\n        :lock-scroll=\"true\"\n    >\n      <div class=\"ai-shell\">\n        <!-- Header -->\n        <div class=\"ai-header\">\n          <div class=\"ai-brand\">\n            <div class=\"ai-brand-icon\">ü§ñ</div>\n            <div class=\"ai-brand-text\">\n              <div class=\"ai-title\">AI Ëá™‰π†ÂÆ§Âä©Êâã</div>\n              <div class=\"ai-subtitle\">È¢ÑÁ∫¶ / Á≠æÂà∞ / ‰ø°Áî®ËßÑÂàô ¬∑ ËΩªÈáèÁâà</div>\n            </div>\n          </div>\n\n          <div class=\"ai-actions\">\n            <el-button size=\"small\" @click=\"clearChat\" :disabled=\"sending\">Ê∏ÖÁ©∫</el-button>\n            <el-button size=\"small\" @click=\"drawerVisible = false\">ÂÖ≥Èó≠</el-button>\n          </div>\n        </div>\n\n        <!-- Âø´Êç∑ÊèêÈóÆÔºàÂèØ‰øùÁïôÔºå‰πüÂèØÂêéÁª≠Âà†Ôºâ -->\n        <div class=\"ai-quick\" v-if=\"showQuick\">\n          <div class=\"ai-quick-row\">\n            <div class=\"ai-quick-label\">Âø´Êç∑ÊèêÈóÆ</div>\n            <div class=\"ai-quick-items\">\n              <el-tag\n                  v-for=\"q in quickQuestions\"\n                  :key=\"q\"\n                  class=\"ai-chip\"\n                  effect=\"plain\"\n                  @click=\"useQuick(q)\"\n              >\n                {{ q }}\n              </el-tag>\n            </div>\n          </div>\n        </div>\n\n        <!-- Messages -->\n        <el-scrollbar class=\"ai-body\">\n          <div class=\"ai-msgs\">\n            <div v-if=\"messages.length === 0\" class=\"ai-empty\">\n              <div class=\"ai-empty-title\">‰ªäÂ§©‰πüË¶ÅÂ•ΩÂ•ΩÂ≠¶‰π†Ôºà‰ΩÜÂà´ÊääËá™Â∑±Â≠¶ÊàêÂºÇÂ∏∏ÂÄºÔºâ</div>\n              <div class=\"ai-empty-desc\">\n                ‰Ω†ÂèØ‰ª•ÈóÆÔºöÊÄé‰πàÈ¢ÑÁ∫¶ÔºüÊàë‰ªäÂ§©ÊúâÂì™‰∫õÈ¢ÑÁ∫¶Ôºü‰∏∫‰ªÄ‰πàÂèòÈ¢ÑË≠¶/ÈªëÂêçÂçïÔºü\n              </div>\n            </div>\n\n            <div\n                v-for=\"m in messages\"\n                :key=\"m.id\"\n                :class=\"['ai-msg', m.role === 'user' ? 'is-user' : 'is-ai']\"\n            >\n              <div class=\"ai-avatar\">\n                <span v-if=\"m.role === 'user'\">‰Ω†</span>\n                <span v-else>AI</span>\n              </div>\n\n              <div class=\"ai-bubble\">\n                <div class=\"ai-text\" v-text=\"m.text\"></div>\n                <div class=\"ai-meta\">{{ formatTime(m.ts) }}</div>\n              </div>\n            </div>\n\n            <div v-if=\"sending\" class=\"ai-msg is-ai\">\n              <div class=\"ai-avatar\">AI</div>\n              <div class=\"ai-bubble\">\n                <div class=\"ai-text\">Ê≠£Âú®ÊÄùËÄÉ‚Ä¶</div>\n              </div>\n            </div>\n          </div>\n        </el-scrollbar>\n\n        <!-- Input -->\n        <div class=\"ai-input\">\n          <el-input\n              v-model=\"inputText\"\n              type=\"textarea\"\n              :autosize=\"{ minRows: 2, maxRows: 5 }\"\n              placeholder=\"ËæìÂÖ•ÈóÆÈ¢òÔºå‰æãÂ¶ÇÔºöÊÄé‰πàÈ¢ÑÁ∫¶ÔºüÊàë‰ªäÂ§©ÊúâÂì™‰∫õÈ¢ÑÁ∫¶Ôºü\"\n              @keydown.enter.exact.prevent=\"send\"\n              @keydown.enter.shift.exact.stop\n          />\n          <div class=\"ai-sendbar\">\n            <div class=\"ai-hint\">Enter ÂèëÈÄÅ ¬∑ Shift+Enter Êç¢Ë°å ¬∑ ÈïøÊåâÊÇ¨ÊµÆÁêÉÂèØÊãñÂä®</div>\n            <el-button\n                class=\"ai-send-btn\"\n                type=\"primary\"\n                :loading=\"sending\"\n                :disabled=\"sending || !inputText.trim()\"\n                @click=\"send\"\n            >\n              ÂèëÈÄÅ\n            </el-button>\n          </div>\n        </div>\n      </div>\n    </el-drawer>\n  </div>\n</template>\n\n<script>\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'AiAssistantLite',\n  props: {\n    userId: {\n      type: [Number, String],\n      default: null\n    }\n  },\n  data () {\n    return {\n      // drawer\n      drawerVisible: false,\n\n      // chat\n      inputText: '',\n      sending: false,\n      conversationId: '',\n      messages: [],\n\n      // quick prompts\n      showQuick: true,\n      quickQuestions: [\n        'ÊÄé‰πàÈ¢ÑÁ∫¶Â∫ß‰ΩçÔºü',\n        'Êàë‰ªäÂ§©ÊúâÂì™‰∫õÈ¢ÑÁ∫¶Ôºü',\n        '‰∏∫‰ªÄ‰πàÊàëÂèòÊàêÈ¢ÑË≠¶/ÈªëÂêçÂçïÔºü',\n        'Â¶Ç‰ΩïÁ≠æÂà∞/Á≠æÈÄÄÔºü'\n      ],\n\n      // floating ball drag\n      floatX: null,\n      floatY: null,\n      dragging: false,\n      longPressTimer: null,\n      longPressMs: 260,\n      startClientX: 0,\n      startClientY: 0,\n      startFloatX: 0,\n      startFloatY: 0,\n      pointerId: null,\n\n      hasUnreadHint: false\n    }\n  },\n  computed: {\n    resolvedUserId () {\n      const p = this.userId\n      if (p !== null && p !== undefined && String(p).trim() !== '') return Number(p)\n\n      try {\n        const raw = localStorage.getItem('ssrmsUser') || sessionStorage.getItem('ssrmsUser')\n        if (!raw) return null\n        const u = JSON.parse(raw)\n        const id = u.userId ?? u.id ?? null\n        return id === null ? null : Number(id)\n      } catch (e) {\n        return null\n      }\n    },\n    storageKey () {\n      return `ssrms_ai_lite_${this.resolvedUserId ?? 'guest'}`\n    },\n    floatPosKey () {\n      return `ssrms_ai_float_pos_${this.resolvedUserId ?? 'guest'}`\n    },\n    floatStyle () {\n      const x = (this.floatX === null || this.floatX === undefined)\n          ? (window.innerWidth - 18 - 56)\n          : this.floatX\n      const y = (this.floatY === null || this.floatY === undefined)\n          ? (window.innerHeight - 18 - 56)\n          : this.floatY\n\n      return { left: `${x}px`, top: `${y}px` }\n    }\n  },\n  mounted () {\n    this.loadFromStorage()\n    this.restoreFloatPos()\n    window.addEventListener('resize', this.clampFloatToViewport)\n  },\n  beforeUnmount () {\n    window.removeEventListener('resize', this.clampFloatToViewport)\n  },\n  watch: {\n    drawerVisible (v) {\n      if (v) {\n        this.hasUnreadHint = false\n        this.$nextTick(() => this.scrollToBottom())\n      }\n    }\n  },\n  methods: {\n    // ---------- ÊÇ¨ÊµÆÁêÉÊãñÂä® ----------\n    restoreFloatPos () {\n      try {\n        const raw = localStorage.getItem(this.floatPosKey)\n        if (!raw) return\n        const obj = JSON.parse(raw)\n        if (typeof obj.x === 'number' && typeof obj.y === 'number') {\n          this.floatX = obj.x\n          this.floatY = obj.y\n          this.clampFloatToViewport()\n        }\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩ‰∏çÂèØÁî®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    saveFloatPos () {\n      try {\n        localStorage.setItem(this.floatPosKey, JSON.stringify({ x: this.floatX, y: this.floatY }))\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩ‰∏çÂèØÁî®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    clampFloatToViewport () {\n      const size = 56\n      const pad = 8\n      const maxX = Math.max(pad, window.innerWidth - size - pad)\n      const maxY = Math.max(pad, window.innerHeight - size - pad)\n\n      if (this.floatX === null || this.floatX === undefined) this.floatX = maxX\n      if (this.floatY === null || this.floatY === undefined) this.floatY = maxY\n\n      this.floatX = Math.min(Math.max(this.floatX, pad), maxX)\n      this.floatY = Math.min(Math.max(this.floatY, pad), maxY)\n    },\n    onPointerDown (e) {\n      if (e.button !== undefined && e.button !== 0) return\n\n      this.pointerId = e.pointerId\n      this.startClientX = e.clientX\n      this.startClientY = e.clientY\n\n      const rect = e.currentTarget.getBoundingClientRect()\n      this.startFloatX = rect.left\n      this.startFloatY = rect.top\n\n      this.longPressTimer = setTimeout(() => {\n        this.dragging = true\n        this.hasUnreadHint = false\n        try {\n          e.currentTarget.setPointerCapture(this.pointerId)\n        } catch (err) {\n          // ÈÉ®ÂàÜÊµèËßàÂô®‰∏çÊîØÊåÅ captureÔºåÂøΩÁï•Âç≥ÂèØ\n        }\n      }, this.longPressMs)\n    },\n    onPointerMove (e) {\n      if (this.pointerId === null || e.pointerId !== this.pointerId) return\n\n      const dx0 = e.clientX - this.startClientX\n      const dy0 = e.clientY - this.startClientY\n      const movedFar = Math.hypot(dx0, dy0) > 10\n\n      if (!this.dragging && movedFar && this.longPressTimer) {\n        clearTimeout(this.longPressTimer)\n        this.longPressTimer = null\n        this.dragging = true\n      }\n\n      if (!this.dragging) return\n\n      const dx = e.clientX - this.startClientX\n      const dy = e.clientY - this.startClientY\n      this.floatX = this.startFloatX + dx\n      this.floatY = this.startFloatY + dy\n      this.clampFloatToViewport()\n    },\n    onPointerUp () {\n      if (this.longPressTimer) {\n        clearTimeout(this.longPressTimer)\n        this.longPressTimer = null\n      }\n\n      if (this.dragging) {\n        this.dragging = false\n        this.pointerId = null\n        this.saveFloatPos()\n        return\n      }\n\n      this.pointerId = null\n      this.openDrawer()\n    },\n\n    // ---------- ËÅäÂ§© ----------\n    openDrawer () {\n      this.drawerVisible = true\n      this.loadFromStorage()\n      this.$nextTick(() => this.scrollToBottom())\n    },\n    loadFromStorage () {\n      try {\n        const raw = localStorage.getItem(this.storageKey)\n        if (!raw) {\n          this.messages = []\n          this.conversationId = ''\n          return\n        }\n        const obj = JSON.parse(raw)\n        this.messages = Array.isArray(obj.messages) ? obj.messages : []\n        this.conversationId = obj.conversationId || ''\n      } catch (e) {\n        this.messages = []\n        this.conversationId = ''\n      }\n    },\n    saveToStorage () {\n      try {\n        localStorage.setItem(this.storageKey, JSON.stringify({\n          conversationId: this.conversationId || '',\n          messages: this.messages || []\n        }))\n      } catch (e) {\n        // Êú¨Âú∞Â≠òÂÇ®ÂèØËÉΩË¢´Á¶ÅÁî®/Á©∫Èó¥‰∏çË∂≥ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    clearChat () {\n      this.messages = []\n      this.conversationId = ''\n      this.saveToStorage()\n      ElMessage.success('Â∑≤Ê∏ÖÁ©∫ÂØπËØù')\n      this.$nextTick(() => this.scrollToBottom())\n    },\n    useQuick (q) {\n      if (this.sending) return\n      this.inputText = q\n      this.$nextTick(() => this.send())\n    },\n    pushMsg (role, text) {\n      const msg = {\n        id: `${Date.now()}_${Math.random().toString(16).slice(2)}`,\n        role,\n        text: String(text ?? ''),\n        ts: Date.now()\n      }\n      this.messages.push(msg)\n      this.saveToStorage()\n      this.$nextTick(() => this.scrollToBottom())\n    },\n    formatTime (ts) {\n      try {\n        const d = new Date(ts)\n        const hh = String(d.getHours()).padStart(2, '0')\n        const mm = String(d.getMinutes()).padStart(2, '0')\n        return `${hh}:${mm}`\n      } catch (e) {\n        return ''\n      }\n    },\n    scrollToBottom () {\n      try {\n        const el = this.$el.querySelector('.ai-body .el-scrollbar__wrap')\n        if (el) el.scrollTop = el.scrollHeight\n      } catch (e) {\n        // DOM ÂÆπÂô®ÂèØËÉΩÊöÇÊú™Ê∏≤ÊüìÊàñ‰∏çÂ≠òÂú®ÔºåÂøΩÁï•Âç≥ÂèØ\n      }\n    },\n    async send () {\n      const text = this.inputText.trim()\n      if (!text || this.sending) return\n\n      if (!this.resolvedUserId) {\n        ElMessage.warning('Êú™Ëé∑ÂèñÂà∞Áî®Êà∑‰ø°ÊÅØÔºåËØ∑ÂÖàÁôªÂΩïÂêéÂÜç‰ΩøÁî® AI Âä©Êâã')\n        return\n      }\n\n      this.pushMsg('user', text)\n      this.inputText = ''\n      this.sending = true\n\n      try {\n        const payload = {\n          userId: this.resolvedUserId,\n          message: text,\n          conversationId: this.conversationId || null\n        }\n\n        // ÂÖºÂÆπÔºö‰Ω†ÁöÑ request.js ÂèØËÉΩÂ∑≤Áªè return response.data\n        const res = await this.$axios.post('/ai/chat', payload)\n        const body = (res && typeof res.code !== 'undefined')\n            ? res\n            : (res && res.data ? res.data : null)\n\n        if (!body || Number(body.code) !== 200) {\n          const msg = (body && (body.msg || body.message)) ? (body.msg || body.message) : 'AI ËØ∑Ê±ÇÂ§±Ë¥•'\n          throw new Error(msg)\n        }\n\n        const data = body.data || {}\n        if (data.conversationId) this.conversationId = data.conversationId\n        this.pushMsg('assistant', data.reply || 'ÔºàAI Êú™ËøîÂõûÂÜÖÂÆπÔºâ')\n      } catch (e) {\n        this.pushMsg('assistant', `ÔºàÂá∫Èîô‰∫ÜÔºâ${e?.message || 'AI ËØ∑Ê±ÇÂ§±Ë¥•'}`)\n      } finally {\n        this.sending = false\n        this.saveToStorage()\n        this.$nextTick(() => this.scrollToBottom())\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.ai-lite-root {}\n\n/* ===== ÊÇ¨ÊµÆÁêÉ ===== */\n.ai-float {\n  position: fixed;\n  z-index: 4000;\n  width: 56px;\n  height: 56px;\n}\n.ai-float-inner {\n  position: relative;\n  width: 56px;\n  height: 56px;\n  border-radius: 999px;\n  background: linear-gradient(180deg, rgba(64,158,255,1) 0%, rgba(64,158,255,0.86) 100%);\n  box-shadow: 0 14px 26px rgba(0,0,0,0.22);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  user-select: none;\n  cursor: pointer;\n  transition: transform 0.15s ease, box-shadow 0.15s ease;\n}\n.ai-float-inner:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 16px 30px rgba(0,0,0,0.24);\n}\n.ai-float-inner.dragging {\n  transform: scale(1.06);\n  box-shadow: 0 18px 34px rgba(0,0,0,0.28);\n  cursor: grabbing;\n}\n.ai-float-emoji {\n  font-size: 22px;\n  line-height: 1;\n}\n.ai-float-dot {\n  position: absolute;\n  right: 6px;\n  top: 6px;\n  width: 10px;\n  height: 10px;\n  border-radius: 999px;\n  background: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255,255,255,0.9);\n}\n\n/* ===== ÊäΩÂ±âÊï¥‰Ωì ===== */\n.ai-shell {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: #f6f7fb;\n}\n.ai-header {\n  padding: 14px 14px 12px;\n  display: flex;\n  justify-content: space-between;\n  gap: 12px;\n  background: #ffffff;\n  border-bottom: 1px solid rgba(0,0,0,0.06);\n}\n.ai-brand { display: flex; gap: 10px; align-items: center; }\n.ai-brand-icon {\n  width: 36px; height: 36px; border-radius: 12px;\n  background: rgba(64,158,255,0.12);\n  display: flex; align-items: center; justify-content: center;\n  font-size: 18px;\n}\n.ai-title { font-weight: 800; font-size: 16px; line-height: 1.1; }\n.ai-subtitle { margin-top: 4px; font-size: 12px; color: rgba(0,0,0,0.55); }\n.ai-actions { display: flex; gap: 8px; flex-shrink: 0; align-items: flex-start; }\n\n/* ===== Âø´Êç∑ÊèêÈóÆ ===== */\n.ai-quick {\n  padding: 10px 14px;\n  background: #ffffff;\n  border-bottom: 1px solid rgba(0,0,0,0.06);\n}\n.ai-quick-row { display: flex; align-items: flex-start; gap: 10px; }\n.ai-quick-label { font-size: 12px; color: rgba(0,0,0,0.55); padding-top: 3px; flex-shrink: 0; }\n.ai-quick-items { display: flex; flex-wrap: wrap; gap: 8px; }\n.ai-chip { cursor: pointer; user-select: none; border-radius: 999px; }\n\n/* ===== Ê∂àÊÅØÂå∫ ===== */\n.ai-body { flex: 1; padding: 12px 14px; }\n.ai-msgs { display: flex; flex-direction: column; gap: 12px; }\n.ai-empty {\n  padding: 14px 12px;\n  border-radius: 14px;\n  background: rgba(255,255,255,0.8);\n  border: 1px dashed rgba(0,0,0,0.12);\n}\n.ai-empty-title { font-weight: 700; font-size: 14px; color: rgba(0,0,0,0.85); }\n.ai-empty-desc { margin-top: 6px; font-size: 12px; color: rgba(0,0,0,0.55); line-height: 1.55; }\n\n.ai-msg { display: flex; gap: 10px; align-items: flex-end; }\n.ai-msg.is-user { flex-direction: row-reverse; }\n\n.ai-avatar {\n  width: 30px; height: 30px; border-radius: 10px;\n  background: rgba(0,0,0,0.06);\n  color: rgba(0,0,0,0.75);\n  display: flex; align-items: center; justify-content: center;\n  font-size: 12px; flex-shrink: 0;\n}\n.ai-msg.is-user .ai-avatar {\n  background: rgba(64,158,255,0.18);\n  color: rgba(64,158,255,1);\n}\n\n.ai-bubble {\n  max-width: 78%;\n  padding: 10px 12px;\n  border-radius: 14px;\n  box-shadow: 0 8px 20px rgba(0,0,0,0.08);\n  background: #ffffff;\n  border: 1px solid rgba(0,0,0,0.04);\n}\n.ai-msg.is-user .ai-bubble {\n  background: rgba(64,158,255,0.12);\n  border: 1px solid rgba(64,158,255,0.10);\n}\n\n.ai-text {\n  white-space: pre-wrap;\n  word-break: break-word;\n  font-size: 13px;\n  line-height: 1.6;\n  color: rgba(0,0,0,0.88);\n}\n.ai-meta {\n  margin-top: 6px;\n  font-size: 11px;\n  color: rgba(0,0,0,0.45);\n  text-align: right;\n}\n\n/* ===== ËæìÂÖ•Âå∫ ===== */\n.ai-input {\n  padding: 12px 14px 14px;\n  background: #ffffff;\n  border-top: 1px solid rgba(0,0,0,0.06);\n}\n.ai-sendbar {\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n}\n.ai-hint { font-size: 12px; color: rgba(0,0,0,0.5); line-height: 1.4; }\n.ai-send-btn { min-width: 84px; border-radius: 12px; }\n\n/* Drawer body Âéª padding */\n:deep(.el-drawer__body) { padding: 0; }\n</style>"],"mappings":";;;AA+HA,SAASA,SAAQ,QAAS,cAAa;AAEvC,eAAe;EACbC,IAAI,EAAE,iBAAiB;EACvBC,KAAK,EAAE;IACLC,MAAM,EAAE;MACNC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;MACtBC,OAAO,EAAE;IACX;EACF,CAAC;EACDC,IAAGA,CAAA,EAAK;IACN,OAAO;MACL;MACAC,aAAa,EAAE,KAAK;MAEpB;MACAC,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE,KAAK;MACdC,cAAc,EAAE,EAAE;MAClBC,QAAQ,EAAE,EAAE;MAEZ;MACAC,SAAS,EAAE,IAAI;MACfC,cAAc,EAAE,CACd,SAAS,EACT,WAAW,EACX,eAAe,EACf,UAAS,CACV;MAED;MACAC,MAAM,EAAE,IAAI;MACZC,MAAM,EAAE,IAAI;MACZC,QAAQ,EAAE,KAAK;MACfC,cAAc,EAAE,IAAI;MACpBC,WAAW,EAAE,GAAG;MAChBC,YAAY,EAAE,CAAC;MACfC,YAAY,EAAE,CAAC;MACfC,WAAW,EAAE,CAAC;MACdC,WAAW,EAAE,CAAC;MACdC,SAAS,EAAE,IAAI;MAEfC,aAAa,EAAE;IACjB;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,cAAaA,CAAA,EAAK;MAChB,MAAMC,CAAA,GAAI,IAAI,CAAC1B,MAAK;MACpB,IAAI0B,CAAA,KAAM,IAAG,IAAKA,CAAA,KAAMC,SAAQ,IAAKxB,MAAM,CAACuB,CAAC,CAAC,CAACE,IAAI,CAAC,MAAM,EAAE,EAAE,OAAO1B,MAAM,CAACwB,CAAC;MAE7E,IAAI;QACF,MAAMG,GAAE,GAAIC,YAAY,CAACC,OAAO,CAAC,WAAW,KAAKC,cAAc,CAACD,OAAO,CAAC,WAAW;QACnF,IAAI,CAACF,GAAG,EAAE,OAAO,IAAG;QACpB,MAAMI,CAAA,GAAIC,IAAI,CAACC,KAAK,CAACN,GAAG;QACxB,MAAMO,EAAC,GAAIH,CAAC,CAACjC,MAAK,IAAKiC,CAAC,CAACG,EAAC,IAAK,IAAG;QAClC,OAAOA,EAAC,KAAM,IAAG,GAAI,IAAG,GAAIlC,MAAM,CAACkC,EAAE;MACvC,EAAE,OAAOC,CAAC,EAAE;QACV,OAAO,IAAG;MACZ;IACF,CAAC;IACDC,UAASA,CAAA,EAAK;MACZ,OAAO,iBAAiB,IAAI,CAACb,cAAa,IAAK,OAAO,EAAC;IACzD,CAAC;IACDc,WAAUA,CAAA,EAAK;MACb,OAAO,sBAAsB,IAAI,CAACd,cAAa,IAAK,OAAO,EAAC;IAC9D,CAAC;IACDe,UAASA,CAAA,EAAK;MACZ,MAAMC,CAAA,GAAK,IAAI,CAAC5B,MAAK,KAAM,IAAG,IAAK,IAAI,CAACA,MAAK,KAAMc,SAAS,GACrDe,MAAM,CAACC,UAAS,GAAI,EAAC,GAAI,EAAE,GAC5B,IAAI,CAAC9B,MAAK;MAChB,MAAM+B,CAAA,GAAK,IAAI,CAAC9B,MAAK,KAAM,IAAG,IAAK,IAAI,CAACA,MAAK,KAAMa,SAAS,GACrDe,MAAM,CAACG,WAAU,GAAI,EAAC,GAAI,EAAE,GAC7B,IAAI,CAAC/B,MAAK;MAEhB,OAAO;QAAEgC,IAAI,EAAE,GAAGL,CAAC,IAAI;QAAEM,GAAG,EAAE,GAAGH,CAAC;MAAK;IACzC;EACF,CAAC;EACDI,OAAMA,CAAA,EAAK;IACT,IAAI,CAACC,eAAe,CAAC;IACrB,IAAI,CAACC,eAAe,CAAC;IACrBR,MAAM,CAACS,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAACC,oBAAoB;EAC7D,CAAC;EACDC,aAAYA,CAAA,EAAK;IACfX,MAAM,CAACY,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAACF,oBAAoB;EAChE,CAAC;EACDG,KAAK,EAAE;IACLjD,aAAYA,CAAGkD,CAAC,EAAE;MAChB,IAAIA,CAAC,EAAE;QACL,IAAI,CAACjC,aAAY,GAAI,KAAI;QACzB,IAAI,CAACkC,SAAS,CAAC,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC;MAC5C;IACF;EACF,CAAC;EACDC,OAAO,EAAE;IACP;IACAT,eAAcA,CAAA,EAAK;MACjB,IAAI;QACF,MAAMrB,GAAE,GAAIC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACQ,WAAW;QACjD,IAAI,CAACV,GAAG,EAAE;QACV,MAAM+B,GAAE,GAAI1B,IAAI,CAACC,KAAK,CAACN,GAAG;QAC1B,IAAI,OAAO+B,GAAG,CAACnB,CAAA,KAAM,QAAO,IAAK,OAAOmB,GAAG,CAAChB,CAAA,KAAM,QAAQ,EAAE;UAC1D,IAAI,CAAC/B,MAAK,GAAI+C,GAAG,CAACnB,CAAA;UAClB,IAAI,CAAC3B,MAAK,GAAI8C,GAAG,CAAChB,CAAA;UAClB,IAAI,CAACQ,oBAAoB,CAAC;QAC5B;MACF,EAAE,OAAOf,CAAC,EAAE;QACV;MAAA;IAEJ,CAAC;IACDwB,YAAWA,CAAA,EAAK;MACd,IAAI;QACF/B,YAAY,CAACgC,OAAO,CAAC,IAAI,CAACvB,WAAW,EAAEL,IAAI,CAAC6B,SAAS,CAAC;UAAEtB,CAAC,EAAE,IAAI,CAAC5B,MAAM;UAAE+B,CAAC,EAAE,IAAI,CAAC9B;QAAO,CAAC,CAAC;MAC3F,EAAE,OAAOuB,CAAC,EAAE;QACV;MAAA;IAEJ,CAAC;IACDe,oBAAmBA,CAAA,EAAK;MACtB,MAAMY,IAAG,GAAI,EAAC;MACd,MAAMC,GAAE,GAAI;MACZ,MAAMC,IAAG,GAAIC,IAAI,CAACC,GAAG,CAACH,GAAG,EAAEvB,MAAM,CAACC,UAAS,GAAIqB,IAAG,GAAIC,GAAG;MACzD,MAAMI,IAAG,GAAIF,IAAI,CAACC,GAAG,CAACH,GAAG,EAAEvB,MAAM,CAACG,WAAU,GAAImB,IAAG,GAAIC,GAAG;MAE1D,IAAI,IAAI,CAACpD,MAAK,KAAM,IAAG,IAAK,IAAI,CAACA,MAAK,KAAMc,SAAS,EAAE,IAAI,CAACd,MAAK,GAAIqD,IAAG;MACxE,IAAI,IAAI,CAACpD,MAAK,KAAM,IAAG,IAAK,IAAI,CAACA,MAAK,KAAMa,SAAS,EAAE,IAAI,CAACb,MAAK,GAAIuD,IAAG;MAExE,IAAI,CAACxD,MAAK,GAAIsD,IAAI,CAACG,GAAG,CAACH,IAAI,CAACC,GAAG,CAAC,IAAI,CAACvD,MAAM,EAAEoD,GAAG,CAAC,EAAEC,IAAI;MACvD,IAAI,CAACpD,MAAK,GAAIqD,IAAI,CAACG,GAAG,CAACH,IAAI,CAACC,GAAG,CAAC,IAAI,CAACtD,MAAM,EAAEmD,GAAG,CAAC,EAAEI,IAAI;IACzD,CAAC;IACDE,aAAYA,CAAGlC,CAAC,EAAE;MAChB,IAAIA,CAAC,CAACmC,MAAK,KAAM7C,SAAQ,IAAKU,CAAC,CAACmC,MAAK,KAAM,CAAC,EAAE;MAE9C,IAAI,CAAClD,SAAQ,GAAIe,CAAC,CAACf,SAAQ;MAC3B,IAAI,CAACJ,YAAW,GAAImB,CAAC,CAACoC,OAAM;MAC5B,IAAI,CAACtD,YAAW,GAAIkB,CAAC,CAACqC,OAAM;MAE5B,MAAMC,IAAG,GAAItC,CAAC,CAACuC,aAAa,CAACC,qBAAqB,CAAC;MACnD,IAAI,CAACzD,WAAU,GAAIuD,IAAI,CAAC7B,IAAG;MAC3B,IAAI,CAACzB,WAAU,GAAIsD,IAAI,CAAC5B,GAAE;MAE1B,IAAI,CAAC/B,cAAa,GAAI8D,UAAU,CAAC,MAAM;QACrC,IAAI,CAAC/D,QAAO,GAAI,IAAG;QACnB,IAAI,CAACQ,aAAY,GAAI,KAAI;QACzB,IAAI;UACFc,CAAC,CAACuC,aAAa,CAACG,iBAAiB,CAAC,IAAI,CAACzD,SAAS;QAClD,EAAE,OAAO0D,GAAG,EAAE;UACZ;QAAA;MAEJ,CAAC,EAAE,IAAI,CAAC/D,WAAW;IACrB,CAAC;IACDgE,aAAYA,CAAG5C,CAAC,EAAE;MAChB,IAAI,IAAI,CAACf,SAAQ,KAAM,IAAG,IAAKe,CAAC,CAACf,SAAQ,KAAM,IAAI,CAACA,SAAS,EAAE;MAE/D,MAAM4D,GAAE,GAAI7C,CAAC,CAACoC,OAAM,GAAI,IAAI,CAACvD,YAAW;MACxC,MAAMiE,GAAE,GAAI9C,CAAC,CAACqC,OAAM,GAAI,IAAI,CAACvD,YAAW;MACxC,MAAMiE,QAAO,GAAIjB,IAAI,CAACkB,KAAK,CAACH,GAAG,EAAEC,GAAG,IAAI,EAAC;MAEzC,IAAI,CAAC,IAAI,CAACpE,QAAO,IAAKqE,QAAO,IAAK,IAAI,CAACpE,cAAc,EAAE;QACrDsE,YAAY,CAAC,IAAI,CAACtE,cAAc;QAChC,IAAI,CAACA,cAAa,GAAI,IAAG;QACzB,IAAI,CAACD,QAAO,GAAI,IAAG;MACrB;MAEA,IAAI,CAAC,IAAI,CAACA,QAAQ,EAAE;MAEpB,MAAMwE,EAAC,GAAIlD,CAAC,CAACoC,OAAM,GAAI,IAAI,CAACvD,YAAW;MACvC,MAAMsE,EAAC,GAAInD,CAAC,CAACqC,OAAM,GAAI,IAAI,CAACvD,YAAW;MACvC,IAAI,CAACN,MAAK,GAAI,IAAI,CAACO,WAAU,GAAImE,EAAC;MAClC,IAAI,CAACzE,MAAK,GAAI,IAAI,CAACO,WAAU,GAAImE,EAAC;MAClC,IAAI,CAACpC,oBAAoB,CAAC;IAC5B,CAAC;IACDqC,WAAUA,CAAA,EAAK;MACb,IAAI,IAAI,CAACzE,cAAc,EAAE;QACvBsE,YAAY,CAAC,IAAI,CAACtE,cAAc;QAChC,IAAI,CAACA,cAAa,GAAI,IAAG;MAC3B;MAEA,IAAI,IAAI,CAACD,QAAQ,EAAE;QACjB,IAAI,CAACA,QAAO,GAAI,KAAI;QACpB,IAAI,CAACO,SAAQ,GAAI,IAAG;QACpB,IAAI,CAACuC,YAAY,CAAC;QAClB;MACF;MAEA,IAAI,CAACvC,SAAQ,GAAI,IAAG;MACpB,IAAI,CAACoE,UAAU,CAAC;IAClB,CAAC;IAED;IACAA,UAASA,CAAA,EAAK;MACZ,IAAI,CAACpF,aAAY,GAAI,IAAG;MACxB,IAAI,CAAC2C,eAAe,CAAC;MACrB,IAAI,CAACQ,SAAS,CAAC,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC;IAC5C,CAAC;IACDT,eAAcA,CAAA,EAAK;MACjB,IAAI;QACF,MAAMpB,GAAE,GAAIC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACO,UAAU;QAChD,IAAI,CAACT,GAAG,EAAE;UACR,IAAI,CAACnB,QAAO,GAAI,EAAC;UACjB,IAAI,CAACD,cAAa,GAAI,EAAC;UACvB;QACF;QACA,MAAMmD,GAAE,GAAI1B,IAAI,CAACC,KAAK,CAACN,GAAG;QAC1B,IAAI,CAACnB,QAAO,GAAIiF,KAAK,CAACC,OAAO,CAAChC,GAAG,CAAClD,QAAQ,IAAIkD,GAAG,CAAClD,QAAO,GAAI,EAAC;QAC9D,IAAI,CAACD,cAAa,GAAImD,GAAG,CAACnD,cAAa,IAAK,EAAC;MAC/C,EAAE,OAAO4B,CAAC,EAAE;QACV,IAAI,CAAC3B,QAAO,GAAI,EAAC;QACjB,IAAI,CAACD,cAAa,GAAI,EAAC;MACzB;IACF,CAAC;IACDoF,aAAYA,CAAA,EAAK;MACf,IAAI;QACF/D,YAAY,CAACgC,OAAO,CAAC,IAAI,CAACxB,UAAU,EAAEJ,IAAI,CAAC6B,SAAS,CAAC;UACnDtD,cAAc,EAAE,IAAI,CAACA,cAAa,IAAK,EAAE;UACzCC,QAAQ,EAAE,IAAI,CAACA,QAAO,IAAK;QAC7B,CAAC,CAAC;MACJ,EAAE,OAAO2B,CAAC,EAAE;QACV;MAAA;IAEJ,CAAC;IACDyD,SAAQA,CAAA,EAAK;MACX,IAAI,CAACpF,QAAO,GAAI,EAAC;MACjB,IAAI,CAACD,cAAa,GAAI,EAAC;MACvB,IAAI,CAACoF,aAAa,CAAC;MACnBhG,SAAS,CAACkG,OAAO,CAAC,OAAO;MACzB,IAAI,CAACtC,SAAS,CAAC,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC;IAC5C,CAAC;IACDsC,QAAOA,CAAGC,CAAC,EAAE;MACX,IAAI,IAAI,CAACzF,OAAO,EAAE;MAClB,IAAI,CAACD,SAAQ,GAAI0F,CAAA;MACjB,IAAI,CAACxC,SAAS,CAAC,MAAM,IAAI,CAACyC,IAAI,CAAC,CAAC;IAClC,CAAC;IACDC,OAAMA,CAAGC,IAAI,EAAEC,IAAI,EAAE;MACnB,MAAMC,GAAE,GAAI;QACVlE,EAAE,EAAE,GAAGmE,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIrC,IAAI,CAACsC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE;QAC1DP,IAAI;QACJC,IAAI,EAAElG,MAAM,CAACkG,IAAG,IAAK,EAAE,CAAC;QACxBO,EAAE,EAAEL,IAAI,CAACC,GAAG,CAAC;MACf;MACA,IAAI,CAAC9F,QAAQ,CAACmG,IAAI,CAACP,GAAG;MACtB,IAAI,CAACT,aAAa,CAAC;MACnB,IAAI,CAACpC,SAAS,CAAC,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC;IAC5C,CAAC;IACDoD,UAASA,CAAGF,EAAE,EAAE;MACd,IAAI;QACF,MAAMG,CAAA,GAAI,IAAIR,IAAI,CAACK,EAAE;QACrB,MAAMI,EAAC,GAAI7G,MAAM,CAAC4G,CAAC,CAACE,QAAQ,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG;QAC/C,MAAMC,EAAC,GAAIhH,MAAM,CAAC4G,CAAC,CAACK,UAAU,CAAC,CAAC,CAAC,CAACF,QAAQ,CAAC,CAAC,EAAE,GAAG;QACjD,OAAO,GAAGF,EAAE,IAAIG,EAAE,EAAC;MACrB,EAAE,OAAO9E,CAAC,EAAE;QACV,OAAO,EAAC;MACV;IACF,CAAC;IACDqB,cAAaA,CAAA,EAAK;MAChB,IAAI;QACF,MAAM2D,EAAC,GAAI,IAAI,CAACC,GAAG,CAACC,aAAa,CAAC,8BAA8B;QAChE,IAAIF,EAAE,EAAEA,EAAE,CAACG,SAAQ,GAAIH,EAAE,CAACI,YAAW;MACvC,EAAE,OAAOpF,CAAC,EAAE;QACV;MAAA;IAEJ,CAAC;IACD,MAAM6D,IAAGA,CAAA,EAAK;MACZ,MAAMG,IAAG,GAAI,IAAI,CAAC9F,SAAS,CAACqB,IAAI,CAAC;MACjC,IAAI,CAACyE,IAAG,IAAK,IAAI,CAAC7F,OAAO,EAAE;MAE3B,IAAI,CAAC,IAAI,CAACiB,cAAc,EAAE;QACxB5B,SAAS,CAAC6H,OAAO,CAAC,yBAAyB;QAC3C;MACF;MAEA,IAAI,CAACvB,OAAO,CAAC,MAAM,EAAEE,IAAI;MACzB,IAAI,CAAC9F,SAAQ,GAAI,EAAC;MAClB,IAAI,CAACC,OAAM,GAAI,IAAG;MAElB,IAAI;QACF,MAAMmH,OAAM,GAAI;UACd3H,MAAM,EAAE,IAAI,CAACyB,cAAc;UAC3BmG,OAAO,EAAEvB,IAAI;UACb5F,cAAc,EAAE,IAAI,CAACA,cAAa,IAAK;QACzC;;QAEA;QACA,MAAMoH,GAAE,GAAI,MAAM,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,UAAU,EAAEJ,OAAO;QACtD,MAAMK,IAAG,GAAKH,GAAE,IAAK,OAAOA,GAAG,CAACI,IAAG,KAAM,WAAW,GAC9CJ,GAAE,GACDA,GAAE,IAAKA,GAAG,CAACxH,IAAG,GAAIwH,GAAG,CAACxH,IAAG,GAAI,IAAI;QAExC,IAAI,CAAC2H,IAAG,IAAK9H,MAAM,CAAC8H,IAAI,CAACC,IAAI,MAAM,GAAG,EAAE;UACtC,MAAM3B,GAAE,GAAK0B,IAAG,KAAMA,IAAI,CAAC1B,GAAE,IAAK0B,IAAI,CAACJ,OAAO,CAAC,GAAKI,IAAI,CAAC1B,GAAE,IAAK0B,IAAI,CAACJ,OAAO,GAAI,SAAQ;UACxF,MAAM,IAAIM,KAAK,CAAC5B,GAAG;QACrB;QAEA,MAAMjG,IAAG,GAAI2H,IAAI,CAAC3H,IAAG,IAAK,CAAC;QAC3B,IAAIA,IAAI,CAACI,cAAc,EAAE,IAAI,CAACA,cAAa,GAAIJ,IAAI,CAACI,cAAa;QACjE,IAAI,CAAC0F,OAAO,CAAC,WAAW,EAAE9F,IAAI,CAAC8H,KAAI,IAAK,YAAY;MACtD,EAAE,OAAO9F,CAAC,EAAE;QACV,IAAI,CAAC8D,OAAO,CAAC,WAAW,EAAE,QAAQ9D,CAAC,EAAEuF,OAAM,IAAK,SAAS,EAAE;MAC7D,UAAU;QACR,IAAI,CAACpH,OAAM,GAAI,KAAI;QACnB,IAAI,CAACqF,aAAa,CAAC;QACnB,IAAI,CAACpC,SAAS,CAAC,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC;MAC5C;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}