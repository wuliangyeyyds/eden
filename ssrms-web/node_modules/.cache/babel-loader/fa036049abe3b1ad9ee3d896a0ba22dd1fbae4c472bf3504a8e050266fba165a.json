{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { defineComponent, inject, ref, computed, watch, nextTick, onBeforeUnmount, unref, openBlock, createElementBlock, normalizeClass, normalizeStyle, createCommentVNode } from 'vue';\nimport { useResizeObserver } from '@vueuse/core';\nimport { tabsRootContextKey } from './constants.mjs';\nimport { tabBarProps } from './tab-bar.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { capitalize } from '../../../utils/strings.mjs';\nimport { throwError } from '../../../utils/error.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { isUndefined } from '../../../utils/types.mjs';\nconst COMPONENT_NAME = \"ElTabBar\";\nconst __default__ = defineComponent({\n  name: COMPONENT_NAME\n});\nconst _sfc_main = /* @__PURE__ */defineComponent({\n  ...__default__,\n  props: tabBarProps,\n  setup(__props, {\n    expose\n  }) {\n    const props = __props;\n    const rootTabs = inject(tabsRootContextKey);\n    if (!rootTabs) throwError(COMPONENT_NAME, \"<el-tabs><el-tab-bar /></el-tabs>\");\n    const ns = useNamespace(\"tabs\");\n    const barRef = ref();\n    const barStyle = ref();\n    const renderActiveBar = computed(() => {\n      var _a;\n      return isUndefined(rootTabs.props.defaultValue) || Boolean((_a = barStyle.value) == null ? void 0 : _a.transform);\n    });\n    const getBarStyle = () => {\n      let offset = 0;\n      let tabSize = 0;\n      const sizeName = [\"top\", \"bottom\"].includes(rootTabs.props.tabPosition) ? \"width\" : \"height\";\n      const sizeDir = sizeName === \"width\" ? \"x\" : \"y\";\n      const position = sizeDir === \"x\" ? \"left\" : \"top\";\n      props.tabs.every(tab => {\n        if (isUndefined(tab.paneName)) return false;\n        const $el = props.tabRefs[tab.paneName];\n        if (!$el) return false;\n        if (!tab.active) {\n          return true;\n        }\n        offset = $el[`offset${capitalize(position)}`];\n        tabSize = $el[`client${capitalize(sizeName)}`];\n        const tabStyles = window.getComputedStyle($el);\n        if (sizeName === \"width\") {\n          tabSize -= Number.parseFloat(tabStyles.paddingLeft) + Number.parseFloat(tabStyles.paddingRight);\n          offset += Number.parseFloat(tabStyles.paddingLeft);\n        }\n        return false;\n      });\n      return {\n        [sizeName]: `${tabSize}px`,\n        transform: `translate${capitalize(sizeDir)}(${offset}px)`\n      };\n    };\n    const update = () => barStyle.value = getBarStyle();\n    const tabObservers = [];\n    const observerTabs = () => {\n      tabObservers.forEach(observer => observer.stop());\n      tabObservers.length = 0;\n      Object.values(props.tabRefs).forEach(tab => {\n        tabObservers.push(useResizeObserver(tab, update));\n      });\n    };\n    watch(() => props.tabs, async () => {\n      await nextTick();\n      update();\n      observerTabs();\n    }, {\n      immediate: true\n    });\n    const barObserver = useResizeObserver(barRef, () => update());\n    onBeforeUnmount(() => {\n      tabObservers.forEach(observer => observer.stop());\n      tabObservers.length = 0;\n      barObserver.stop();\n    });\n    expose({\n      ref: barRef,\n      update\n    });\n    return (_ctx, _cache) => {\n      return unref(renderActiveBar) ? (openBlock(), createElementBlock(\"div\", {\n        key: 0,\n        ref_key: \"barRef\",\n        ref: barRef,\n        class: normalizeClass([unref(ns).e(\"active-bar\"), unref(ns).is(unref(rootTabs).props.tabPosition)]),\n        style: normalizeStyle(barStyle.value)\n      }, null, 6)) : createCommentVNode(\"v-if\", true);\n    };\n  }\n});\nvar TabBar = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"tab-bar.vue\"]]);\nexport { TabBar as default };","map":{"version":3,"names":["name","COMPONENT_NAME","rootTabs","inject","tabsRootContextKey","throwError","ns","useNamespace","barRef","ref","barStyle","renderActiveBar","computed","_a","isUndefined","props","defaultValue","Boolean","value","transform","getBarStyle","offset","tabSize","sizeName","includes","tabPosition","sizeDir","position","tabs","every","tab","paneName","$el","tabRefs","active","capitalize","tabStyles","window","getComputedStyle","Number","parseFloat","paddingLeft","paddingRight","update","tabObservers","observerTabs","forEach","observer","stop","length","Object","values","push","useResizeObserver","watch","nextTick","immediate","barObserver","onBeforeUnmount","expose","_ctx","_cache","unref","openBlock","createElementBlock"],"sources":["../../../../../../packages/components/tabs/src/tab-bar.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"renderActiveBar\"\n    ref=\"barRef\"\n    :class=\"[ns.e('active-bar'), ns.is(rootTabs!.props.tabPosition)]\"\n    :style=\"barStyle\"\n  />\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, nextTick, onBeforeUnmount, ref, watch } from 'vue'\nimport { useResizeObserver } from '@vueuse/core'\nimport { capitalize, isUndefined, throwError } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport { tabsRootContextKey } from './constants'\nimport { tabBarProps } from './tab-bar'\n\nimport type { CSSProperties } from 'vue'\n\nconst COMPONENT_NAME = 'ElTabBar'\ndefineOptions({\n  name: COMPONENT_NAME,\n})\nconst props = defineProps(tabBarProps)\n\nconst rootTabs = inject(tabsRootContextKey)\nif (!rootTabs) throwError(COMPONENT_NAME, '<el-tabs><el-tab-bar /></el-tabs>')\n\nconst ns = useNamespace('tabs')\n\nconst barRef = ref<HTMLDivElement>()\nconst barStyle = ref<CSSProperties>()\n/**\n * when defaultValue is not set, the bar is always shown.\n *\n * when defaultValue is set, the bar will be hidden until style is calculated\n * to avoid the bar showing in the wrong position on initial render.\n */\nconst renderActiveBar = computed(\n  () =>\n    isUndefined(rootTabs.props.defaultValue) ||\n    Boolean(barStyle.value?.transform)\n)\n\nconst getBarStyle = (): CSSProperties => {\n  let offset = 0\n  let tabSize = 0\n\n  const sizeName = ['top', 'bottom'].includes(rootTabs.props.tabPosition)\n    ? 'width'\n    : 'height'\n  const sizeDir = sizeName === 'width' ? 'x' : 'y'\n  const position = sizeDir === 'x' ? 'left' : 'top'\n\n  props.tabs.every((tab) => {\n    if (isUndefined(tab.paneName)) return false\n    const $el = props.tabRefs[tab.paneName]\n    if (!$el) return false\n\n    if (!tab.active) {\n      return true\n    }\n\n    offset = $el[`offset${capitalize(position)}`]\n    tabSize = $el[`client${capitalize(sizeName)}`]\n\n    const tabStyles = window.getComputedStyle($el)\n\n    if (sizeName === 'width') {\n      tabSize -=\n        Number.parseFloat(tabStyles.paddingLeft) +\n        Number.parseFloat(tabStyles.paddingRight)\n      offset += Number.parseFloat(tabStyles.paddingLeft)\n    }\n    return false\n  })\n\n  return {\n    [sizeName]: `${tabSize}px`,\n    transform: `translate${capitalize(sizeDir)}(${offset}px)`,\n  }\n}\n\nconst update = () => (barStyle.value = getBarStyle())\n\nconst tabObservers = [] as ReturnType<typeof useResizeObserver>[]\nconst observerTabs = () => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n\n  Object.values(props.tabRefs).forEach((tab) => {\n    tabObservers.push(useResizeObserver(tab, update))\n  })\n}\n\nwatch(\n  () => props.tabs,\n  async () => {\n    await nextTick()\n    update()\n\n    observerTabs()\n  },\n  { immediate: true }\n)\nconst barObserver = useResizeObserver(barRef, () => update())\n\nonBeforeUnmount(() => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n  barObserver.stop()\n})\n\ndefineExpose({\n  /** @description tab root html element */\n  ref: barRef,\n  /** @description method to manually update tab bar style */\n  update,\n})\n</script>\n"],"mappings":";;;;;;;;;;;;;;mCAoBc;EACZA,IAAM,EAAAC;AACR;;;;;;;;IAGM,MAAAC,QAAA,GAAWC,MAAA,CAAOC,kBAAkB;IAC1C,IAAI,CAACF,QAAA,EAECG,UAAA,CAAAJ,cAAwB;IAE9B,MAAMK,EAAA,GAAAC,YAA6B;IACnC,MAAMC,MAAA,GAAAC,GAA8B;IAOpC,MAAMC,QAAkB,GAAAD,GAAA;IACtB,MAAAE,eACuB,GAAAC,QAAA;MAEzB,IAAAC,EAAA;MAEA,OAAAC,WAAoB,CAAqBZ,QAAA,CAAAa,KAAA,CAAAC,YAAA,KAAAC,OAAA,EAAAJ,EAAA,GAAAH,QAAA,CAAAQ,KAAA,qBAAAL,EAAA,CAAAM,SAAA;IACvC;IACA,MAAIC,WAAU,GAAAA,CAAA;MAER,IAAAC,MAAA;MAGA,IAAAC,OAAA;MACA,MAAAC,QAAA,GAAW,CAAY,iBAAMC,QAAS,CAAAtB,QAAA,CAAAa,KAAA,CAAAU,WAAA;MAEtC,MAAAC,OAAW,GAAAH,QAAS;MACxB,MAAII,QAAY,GAAAD,OAAY,QAAG,GAAO;MACtCX,KAAA,CAAAa,IAAY,CAAAC,KAAA,CAAAC,GAAc;QACtB,IAAAhB,WAAa,CAAAgB,GAAA,CAAAC,QAAA,GAEb,OAAK,KAAQ;QACR,MAAAC,GAAA,GAAAjB,KAAA,CAAAkB,OAAA,CAAAH,GAAA,CAAAC,QAAA;QACT,KAAAC,GAAA,EAEA,OAAS,KAAI;QACb,KAAAF,GAAA,CAAAI,MAAc;UAER;QAEN;QAEIb,MAAA,GAAAW,GAAA,UAAOG,UAAqB,CAAAR,QAAA;QAEpBL,OAAA,GAAAU,GAAA,UAAkBG,UAAA,CAAAZ,QAAqB;QACnD,MAAAa,SAAA,GAAAC,MAAA,CAAAC,gBAAA,CAAAN,GAAA;QACO,IAAAT,QAAA;UACRD,OAAA,IAAAiB,MAAA,CAAAC,UAAA,CAAAJ,SAAA,CAAAK,WAAA,IAAAF,MAAA,CAAAC,UAAA,CAAAJ,SAAA,CAAAM,YAAA;UAEMrB,MAAA,IAAAkB,MAAA,CAAAC,UAAA,CAAAJ,SAAA,CAAAK,WAAA;QAAA;QAEL,YAAuB;MAA6B,CACtD;MACF;QAEA,CAAAlB,QAAe,MAAAD,OAAgB;QAE/BH,SAAA,cAAsBgB,UAAA,CAAAT,OAAA,KAAAL,MAAA;MACtB;IACE;IACA,MAAAsB,MAAA,GAAaA,CAAA,KAASjC,QAAA,CAAAQ,KAAA,GAAAE,WAAA;IAEtB,MAAAwB,YAAoB;IAClB,MAAAC,YAAkB,GAAAA,CAAA;MACpBD,YAAC,CAAAE,OAAA,CAAAC,QAAA,IAAAA,QAAA,CAAAC,IAAA;MACHJ,YAAA,CAAAK,MAAA;MAEAC,MAAA,CAAAC,MAAA,CAAApC,KAAA,CAAAkB,OAAA,EAAAa,OAAA,CAAAhB,GAAA;QAAAc,YACc,CAAAQ,IAAA,CAAAC,iBAAA,CAAAvB,GAAA,EAAAa,MAAA;MAAA,CACA;IACV;IACOW,KAAA,OAAAvC,KAAA,CAAAa,IAAA;MAEM,MAAA2B,QAAA;MACfZ,MAAA;MACAE,YAAA,EAAkB;IAAA,CACpB;MAAAW,SAAA;IAAA;IACA,MAAMC,WAAc,GAAAJ,iBAAA,CAAkB7C,MAAQ,QAAMmC,MAAA,EAAQ;IAE5De,eAAA,CAAgB,MAAM;MACpBd,YAAA,CAAaE,OAAQ,CAACC,QAAa,IAAAA,QAAA,CAASC,IAAA,EAAM;MAClDJ,YAAA,CAAaK,MAAS;MACtBQ,WAAA,CAAYT,IAAK;IAAA,CAClB;IAEYW,MAAA;MAAAlD,GAAA,EAAAD,MAAA;MAEXmC;IAAK;IAEL,QAAAiB,IAAA,EAAAC,MAAA;MACD,OAAAC,KAAA,CAAAnD,eAAA,KAAAoD,SAAA,IAAAC,kBAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}