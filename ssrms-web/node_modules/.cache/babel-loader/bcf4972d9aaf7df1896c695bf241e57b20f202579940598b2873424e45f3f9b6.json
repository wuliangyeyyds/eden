{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nexport default {\n  name: 'AppHome',\n  props: {\n    currentPage: {\n      type: String,\n      required: true\n    }\n  },\n  emits: ['change-page'],\n  data() {\n    return {\n      // 场地（地点）列表\n      reserveVenues: ['本部 · 图书馆 301', '本部 · 图书馆 401', '东校区 · 教学楼 3 楼'],\n      reserveVenueIndex: 0,\n      // 日期相关\n      dateList: [],\n      visibleStart: 0,\n      visibleCount: 7,\n      // 一屏展示多少天\n      currentDateIndex: 0,\n      // 时间段列表（0 点~24 点）\n      timeSlots: [],\n      // 后端返回的“已满时段”（id 列表，例如 [8,9,14]）\n      disabledSlotIds: [],\n      // 已选时段（最多 4 个）\n      selectedSlots: [],\n      // 是否只展示“可预约”的时段\n      onlyShowAvailable: false,\n      // 房间 id 映射（按顺序和 reserveVenues 对应）\n      roomIds: [1, 2, 3],\n      // 换成你 room 表里的真实 id\n\n      // 当前登录用户 id（从登录时存的用户信息里读）\n      currentUserId: null,\n      // 我的预约列表\n      myReservations: [],\n      // 我的预约分页\n      pageSize: 15,\n      reservationPageIndex: 1\n    };\n  },\n  computed: {\n    visibleDates() {\n      return this.dateList.slice(this.visibleStart, this.visibleStart + this.visibleCount).map((d, idx) => ({\n        ...d,\n        index: this.visibleStart + idx\n      }));\n    },\n    canMovePrev() {\n      return this.visibleStart > 0;\n    },\n    canMoveNext() {\n      return this.visibleStart + this.visibleCount < this.dateList.length;\n    },\n    currentVenueName() {\n      return this.reserveVenues[this.reserveVenueIndex] || '';\n    },\n    // 当前选中的日期完整文本（用于右侧概要）\n    currentDateLabel() {\n      const cur = this.dateList[this.currentDateIndex];\n      return cur ? cur.fullLabel : '';\n    },\n    // 根据开关过滤时间段列表\n    filteredTimeSlots() {\n      if (!this.onlyShowAvailable) {\n        return this.timeSlots;\n      }\n      // 只展示“可预约”的时段\n      return this.timeSlots.filter(slot => this.slotState(slot) === 'available');\n    },\n    // 当前房间 id\n    currentRoomId() {\n      return this.roomIds[this.reserveVenueIndex];\n    },\n    // 后端需要 yyyy-MM-dd 格式的日期字符串\n    currentDateStr() {\n      const cur = this.dateList[this.currentDateIndex];\n      // 我们在 initDates 里已经生成了 fullLabel = '2025-12-13'\n      return cur ? cur.fullLabel : null;\n    },\n    // 总页数\n    totalPages() {\n      if (!this.myReservations.length) return 0;\n      return Math.ceil(this.myReservations.length / this.pageSize);\n    },\n    // 当前页要展示的 15 条\n    pagedReservations() {\n      if (!this.myReservations.length) return [];\n      const total = this.totalPages || 1;\n      const page = Math.min(this.reservationPageIndex, total);\n      const start = (page - 1) * this.pageSize;\n      const end = start + this.pageSize;\n      return this.myReservations.slice(start, end);\n    }\n  },\n  created() {\n    // 初始化时间段、日期\n    this.timeSlots = this.buildTimeSlots();\n    this.initDates();\n\n    // 读取当前登录用户：从 localStorage 的 ssrmsUser 里取\n    const raw = localStorage.getItem('ssrmsUser');\n    if (raw) {\n      try {\n        const user = JSON.parse(raw);\n        this.currentUserId = user.id; // 如果你的主键不是 id，而是 userId，就改成 user.userId\n      } catch (e) {\n        console.error(e);\n      }\n    }\n\n    // 初始化完后拉一次当天的占用情况\n    this.fetchSlotStatus();\n  },\n  methods: {\n    emitChange(page) {\n      this.$emit('change-page', page);\n    },\n    // 点击场地 tab\n    handleVenueClick(index) {\n      this.reserveVenueIndex = index;\n      this.fetchSlotStatus();\n    },\n    // 构造 24 个时间段（0-1 点，1-2 点...）\n    buildTimeSlots() {\n      const list = [];\n      for (let h = 0; h < 24; h++) {\n        const next = (h + 1) % 24;\n        const id = String(h);\n        const range = `${h.toString().padStart(2, '0')}:00 - ` + `${next.toString().padStart(2, '0')}:00`;\n        const label = (h % 12 === 0 ? 12 : h % 12) + ': 00 ' + (h < 12 ? 'AM' : 'PM');\n        list.push({\n          id,\n          label,\n          range\n        });\n      }\n      return list;\n    },\n    // 生成接下来 14 天的日期条\n    initDates() {\n      const today = new Date();\n      const list = [];\n      const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\n      for (let i = 0; i < 14; i++) {\n        const d = new Date(today);\n        d.setDate(d.getDate() + i);\n        const month = d.getMonth() + 1;\n        const day = d.getDate();\n        const fullLabel = `${d.getFullYear()}-${month.toString().padStart(2, '0')}-` + `${day.toString().padStart(2, '0')}`;\n        list.push({\n          key: i,\n          year: d.getFullYear(),\n          month,\n          day,\n          weekday: weekdays[d.getDay()],\n          monthLabel: `${d.getFullYear()}-${month.toString().padStart(2, '0')}`,\n          isToday: i === 0,\n          isTomorrow: i === 1,\n          fullLabel\n        });\n      }\n      this.dateList = list;\n      this.visibleStart = 0;\n      this.currentDateIndex = 0;\n    },\n    moveDates(direction) {\n      if (direction === 'prev' && this.canMovePrev) {\n        this.visibleStart -= 1;\n      } else if (direction === 'next' && this.canMoveNext) {\n        this.visibleStart += 1;\n      }\n    },\n    // 点击日期\n    selectDate(index) {\n      this.currentDateIndex = index;\n      this.fetchSlotStatus();\n    },\n    buildKey(dateIndex, slotId) {\n      return `${dateIndex}-${slotId}`;\n    },\n    // 当前时段是可预约 / 已选 / 不可预约\n    slotState(slot) {\n      if (this.disabledSlotIds.includes(slot.id)) {\n        return 'disabled';\n      }\n      const key = this.buildKey(this.currentDateIndex, slot.id);\n      const exists = this.selectedSlots.some(item => item.key === key);\n      if (exists) {\n        return 'selected';\n      }\n      return 'available';\n    },\n    slotClass(slot) {\n      const state = this.slotState(slot);\n      return {\n        'slot-available': state === 'available',\n        'slot-disabled': state === 'disabled',\n        'slot-selected': state === 'selected'\n      };\n    },\n    // 点击时段：选中 / 取消\n    toggleSlot(slot) {\n      if (this.slotState(slot) === 'disabled') {\n        return;\n      }\n      const key = this.buildKey(this.currentDateIndex, slot.id);\n      const index = this.selectedSlots.findIndex(item => item.key === key);\n      if (index !== -1) {\n        this.selectedSlots.splice(index, 1);\n        return;\n      }\n      if (this.selectedSlots.length >= 4) {\n        alert('最多只能选择 4 个预约时段');\n        return;\n      }\n      const dateInfo = this.dateList[this.currentDateIndex];\n      const dateLabel = dateInfo.fullLabel;\n      this.selectedSlots.push({\n        key,\n        dateIndex: this.currentDateIndex,\n        dateLabel,\n        slot\n      });\n    },\n    removeSelected(key) {\n      const index = this.selectedSlots.findIndex(item => item.key === key);\n      if (index !== -1) {\n        this.selectedSlots.splice(index, 1);\n      }\n    },\n    resetSelections() {\n      this.selectedSlots = [];\n    },\n    // 提交预约：调用后端 /reservation/create\n    async submitReservations() {\n      if (!this.selectedSlots.length) return;\n      if (!this.currentUserId) {\n        alert('请先登录后再预约');\n        return;\n      }\n      const slotIds = this.selectedSlots.map(item => Number(item.slot.id));\n      try {\n        const resp = await this.$axios.post('/reservation/create', {\n          userId: this.currentUserId,\n          // 先直接传，之后可以改成后端从登录态获取\n          roomId: this.currentRoomId,\n          date: this.currentDateStr,\n          slotIds\n        });\n        const result = resp.data;\n        if (result.code && result.code !== 200) {\n          alert(result.msg || '预约失败');\n          return;\n        }\n        alert('预约成功');\n        // 清空选择\n        this.selectedSlots = [];\n        // 重新拉一遍时段状态，刷新灰色/可选状态\n        await this.fetchSlotStatus();\n        // 保留原来的行为：预约后跳到“我的预约”\n        this.emitChange('user-reservations');\n      } catch (e) {\n        console.error(e);\n        alert('预约失败，服务器异常');\n      }\n    },\n    // 从后端拉取某房间某天的“已满时段”\n    async fetchSlotStatus() {\n      // 房间或日期还没准备好就先不调\n      if (!this.currentRoomId || !this.currentDateStr) return;\n      try {\n        const resp = await this.$axios.get('/reservation/slots', {\n          params: {\n            roomId: this.currentRoomId,\n            date: this.currentDateStr\n          }\n        });\n        const result = resp.data;\n        const dto = result.data || {};\n        // 后端返回的是 [8,9,14] 这样，我们前端用字符串 id\n        this.disabledSlotIds = (dto.disabledSlotIds || []).map(id => String(id));\n      } catch (e) {\n        console.error(e);\n        alert('获取时段状态失败');\n      }\n    },\n    // 把后端返回的预约列表加载到表格\n    async loadMyReservations() {\n      // 确保有 currentUserId，没有的话再尝试从 localStorage 读一次\n      if (!this.currentUserId) {\n        const raw = localStorage.getItem('ssrmsUser');\n        if (raw) {\n          try {\n            const user = JSON.parse(raw);\n            this.currentUserId = user.id; // 如果主键叫 userId，就改成 user.userId\n          } catch (e) {\n            console.error(e);\n          }\n        }\n      }\n      if (!this.currentUserId) return;\n      try {\n        const resp = await this.$axios.get('/reservation/my', {\n          params: {\n            userId: this.currentUserId\n          }\n        });\n        const result = resp.data;\n        const list = Array.isArray(result.data) ? result.data.slice() : [];\n\n        // 前端排序：日期倒序（新→旧），同一天按开始时间升序\n        list.sort((a, b) => {\n          const da = a.date || '';\n          const db = b.date || '';\n          if (da !== db) {\n            // 倒序：大的在前\n            return db.localeCompare(da);\n          }\n          const ta = a.startTime || '';\n          const tb = b.startTime || '';\n          return ta.localeCompare(tb);\n        });\n        this.myReservations = list;\n      } catch (e) {\n        console.error(e);\n        alert('加载预约列表失败');\n      }\n    },\n    // 把 startTime / endTime 拼成 “HH:mm-HH:mm”\n    formatTimeRange(item) {\n      const s = (item.startTime || '').slice(0, 5);\n      const e = (item.endTime || '').slice(0, 5);\n      return s && e ? `${s}-${e}` : '';\n    },\n    // 把后端状态英文转成中文文案\n    renderStatusText(status) {\n      switch (status) {\n        case 'reserved':\n          return '待签到';\n        case 'checked_in':\n          return '已签到';\n        case 'late':\n          return '迟到';\n        case 'no_show':\n          return '未签到';\n        case 'cancelled':\n          return '已取消';\n        default:\n          return status || '';\n      }\n    },\n    // 根据状态决定徽标颜色（先留好钩子，样式后面想美化再改）\n    statusClass(status) {\n      return {\n        'badge-pending': status === 'reserved',\n        'badge-done': status === 'checked_in',\n        'badge-late': status === 'late',\n        'badge-missed': status === 'no_show',\n        'badge-cancelled': status === 'cancelled'\n      };\n    },\n    gotoPrevPage() {\n      if (this.reservationPageIndex > 1) {\n        this.reservationPageIndex--;\n      }\n    },\n    gotoNextPage() {\n      if (this.reservationPageIndex < this.totalPages) {\n        this.reservationPageIndex++;\n      }\n    },\n    // 签到\n    async handleCheckIn(item) {\n      try {\n        const resp = await this.$axios.post(`/reservation/checkin/${item.id}`);\n        const result = resp.data;\n        if (result.code && result.code !== 200) {\n          alert(result.msg || '签到失败');\n          return;\n        }\n        alert(result.msg || '签到成功');\n        // 重新刷新列表和占用情况\n        await this.loadMyReservations();\n        // 如果你希望“我要预约”那边也立即刷新占用，可以顺带：\n        // await this.fetchSlotStatus()\n      } catch (e) {\n        console.error(e);\n        alert('签到失败，服务器异常');\n      }\n    },\n    // 取消占位，后面再实现\n    async handleCancel(item) {\n      // 前端再保险一次 10 分钟规则\n      if (!this.canCancel(item)) {\n        alert('距离开始不足 10 分钟，无法取消，请联系管理员处理');\n        return;\n      }\n      const ok = window.confirm(`确定要取消本次预约（${item.date} ${this.formatTimeRange(item)}）吗？`);\n      if (!ok) {\n        return;\n      }\n      try {\n        const resp = await this.$axios.post(`/reservation/cancel/${item.id}`);\n        const result = resp.data || {};\n        if (result.code && result.code !== 200) {\n          alert(result.msg || '取消失败');\n          return;\n        }\n        alert(result.msg || '取消成功');\n        // 重新加载预约列表\n        await this.loadMyReservations();\n        // 同时刷新一下“我要预约”那边的占用情况（释放座位）\n        await this.fetchSlotStatus();\n      } catch (e) {\n        console.error(e);\n        alert('取消失败，服务器异常');\n      }\n    },\n    // 是否还允许取消：只在开始时间 10 分钟前才允许\n    canCancel(item) {\n      if (item.status !== 'reserved') return false;\n      if (!item.date || !item.startTime) return false;\n      try {\n        // 后端传来的格式大概率是：date = '2025-12-22', startTime = '01:00:00'\n        const startStr = item.date + 'T' + (item.startTime || '').slice(0, 8);\n        const start = new Date(startStr);\n        if (isNaN(start.getTime())) {\n          // 解析失败就不在前端拦，交给后端判断\n          return true;\n        }\n        const now = new Date();\n        const diffMs = start.getTime() - now.getTime();\n        const tenMinutes = 10 * 60 * 1000;\n        // diffMs > 10 分钟 ⇒ 可以取消\n        return diffMs > tenMinutes;\n      } catch (e) {\n        console.error(e);\n        // 出异常直接放行，交给后端\n        return true;\n      }\n    }\n  },\n  watch: {\n    currentPage(newVal) {\n      if (newVal === 'user-reservations') {\n        this.loadMyReservations();\n      }\n      if (newVal === 'user-reserve') {\n        this.fetchSlotStatus();\n      }\n    },\n    myReservations() {\n      // 每次重新加载列表，从第 1 页开始\n      this.reservationPageIndex = 1;\n    }\n  }\n};","map":{"version":3,"names":["name","props","currentPage","type","String","required","emits","data","reserveVenues","reserveVenueIndex","dateList","visibleStart","visibleCount","currentDateIndex","timeSlots","disabledSlotIds","selectedSlots","onlyShowAvailable","roomIds","currentUserId","myReservations","pageSize","reservationPageIndex","computed","visibleDates","slice","map","d","idx","index","canMovePrev","canMoveNext","length","currentVenueName","currentDateLabel","cur","fullLabel","filteredTimeSlots","filter","slot","slotState","currentRoomId","currentDateStr","totalPages","Math","ceil","pagedReservations","total","page","min","start","end","created","buildTimeSlots","initDates","raw","localStorage","getItem","user","JSON","parse","id","e","console","error","fetchSlotStatus","methods","emitChange","$emit","handleVenueClick","list","h","next","range","toString","padStart","label","push","today","Date","weekdays","i","setDate","getDate","month","getMonth","day","getFullYear","key","year","weekday","getDay","monthLabel","isToday","isTomorrow","moveDates","direction","selectDate","buildKey","dateIndex","slotId","includes","exists","some","item","slotClass","state","toggleSlot","findIndex","splice","alert","dateInfo","dateLabel","removeSelected","resetSelections","submitReservations","slotIds","Number","resp","$axios","post","userId","roomId","date","result","code","msg","get","params","dto","loadMyReservations","Array","isArray","sort","a","b","da","db","localeCompare","ta","startTime","tb","formatTimeRange","s","endTime","renderStatusText","status","statusClass","gotoPrevPage","gotoNextPage","handleCheckIn","handleCancel","canCancel","ok","window","confirm","startStr","isNaN","getTime","now","diffMs","tenMinutes","watch","newVal"],"sources":["D:\\code\\SpringBoot-Vue-SSRMS\\ssrms-web\\src\\components\\UserHome.vue"],"sourcesContent":["<template>\r\n  <div class=\"main\">\r\n    <!-- 首页 -->\r\n    <div v-if=\"currentPage === 'home'\" class=\"home-wrapper\">\r\n      <div class=\"card home-card\">\r\n        <!-- 上半部分：左文字 -->\r\n        <div class=\"home-top\">\r\n          <div class=\"home-intro\">\r\n            <h2 class=\"page-title\">欢迎使用自习室预约系统（学生端）</h2>\r\n            <p class=\"page-subtitle\">\r\n              你可以在这里快速查看自习室开放情况、预约座位、查看自己的预约记录以及违规状态等。\r\n            </p>\r\n            <p class=\"home-tagline\">\r\n              建议提前 <strong>30 分钟</strong> 到达自习室完成签到，保持良好信用记录。\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 今日概况 -->\r\n        <div class=\"overview-wrapper\">\r\n          <div class=\"home-panel\">\r\n            <div>\r\n              <div class=\"home-panel-title\">今日自习室概况</div>\r\n              <div class=\"home-panel-number\">180 个座位</div>\r\n              <div class=\"home-panel-desc\">\r\n                已预约 72 · 正在使用 58 · 剩余 50\r\n              </div>\r\n            </div>\r\n            <div class=\"home-panel-footer\">\r\n              高峰时段：<span>19:00–21:30</span> · 301 自习室接近满座。\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 我要预约页面（美化版） -->\r\n    <div v-else-if=\"currentPage === 'user-reserve'\">\r\n      <div class=\"card reserve-card\">\r\n        <!-- 顶部：标题 + 当前选择概览 -->\r\n        <div class=\"reserve-header-row\">\r\n          <div class=\"reserve-header-left\">\r\n            <h2 class=\"page-title\">我要预约</h2>\r\n            <p class=\"page-subtitle\">\r\n              选择自习室、日期和时间段进行预约，点击卡片选择 / 取消，最多可同时选择 4 个时段。\r\n            </p>\r\n          </div>\r\n\r\n          <!-- 右侧：当前选择概要 -->\r\n          <div class=\"reserve-summary-box\">\r\n            <div class=\"summary-title\">当前选择</div>\r\n            <div class=\"summary-main\">\r\n              <div class=\"summary-row\">\r\n                <span class=\"summary-label\">场地</span>\r\n                <span class=\"summary-value\">\r\n              {{ currentVenueName }}\r\n            </span>\r\n              </div>\r\n              <div class=\"summary-row\">\r\n                <span class=\"summary-label\">日期</span>\r\n                <span class=\"summary-value\">\r\n              {{ currentDateLabel || '请选择日期' }}\r\n            </span>\r\n              </div>\r\n              <div class=\"summary-row\">\r\n                <span class=\"summary-label\">时段</span>\r\n                <span\r\n                    class=\"summary-value\"\r\n                    v-if=\"selectedSlots.length\"\r\n                >\r\n              已选 {{ selectedSlots.length }} / 4 个\r\n            </span>\r\n                <span\r\n                    class=\"summary-value summary-empty\"\r\n                    v-else\r\n                >\r\n              尚未选择\r\n            </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 场地选择 + “只看可预约”开关 -->\r\n        <div class=\"reserve-toolbar\">\r\n          <div class=\"venue-tabs\">\r\n            <button\r\n                v-for=\"(venue, index) in reserveVenues\"\r\n                :key=\"venue\"\r\n                type=\"button\"\r\n                class=\"venue-tab\"\r\n                :class=\"{ active: reserveVenueIndex === index }\"\r\n                @click=\"handleVenueClick(index)\"\r\n            >\r\n              {{ venue }}\r\n            </button>\r\n          </div>\r\n\r\n          <div class=\"reserve-toolbar-right\">\r\n            <span class=\"switch-label\">只看可预约时段</span>\r\n            <!-- Element Plus 的开关组件 -->\r\n            <el-switch\r\n                v-model=\"onlyShowAvailable\"\r\n                size=\"small\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 日期条 -->\r\n        <div class=\"date-strip\">\r\n          <button\r\n              class=\"date-arrow\"\r\n              type=\"button\"\r\n              @click=\"moveDates('prev')\"\r\n              :disabled=\"!canMovePrev\"\r\n          >\r\n            ‹\r\n          </button>\r\n\r\n          <div class=\"date-list\">\r\n            <button\r\n                v-for=\"d in visibleDates\"\r\n                :key=\"d.key\"\r\n                type=\"button\"\r\n                class=\"date-item\"\r\n                :class=\"{ active: currentDateIndex === d.index }\"\r\n                @click=\"selectDate(d.index)\"\r\n            >\r\n              <div class=\"date-month\">{{ d.monthLabel }}</div>\r\n              <div class=\"date-day-row\">\r\n                <span class=\"date-day-number\">{{ d.day }}</span>\r\n                <span class=\"date-weekday\">{{ d.weekday }}</span>\r\n              </div>\r\n              <div class=\"date-extra\" v-if=\"d.isToday\">今天</div>\r\n              <div class=\"date-extra\" v-else-if=\"d.isTomorrow\">明天</div>\r\n            </button>\r\n          </div>\r\n\r\n          <button\r\n              class=\"date-arrow\"\r\n              type=\"button\"\r\n              @click=\"moveDates('next')\"\r\n              :disabled=\"!canMoveNext\"\r\n          >\r\n            ›\r\n          </button>\r\n        </div>\r\n\r\n        <!-- 时间段选择区域 -->\r\n        <div class=\"slot-section\">\r\n          <div class=\"slot-header\">\r\n            <div class=\"slot-title\">选择时间段</div>\r\n            <div class=\"slot-legend\">\r\n          <span class=\"legend-item\">\r\n            <span class=\"legend-dot legend-available\"></span>可预约\r\n          </span>\r\n              <span class=\"legend-item\">\r\n            <span class=\"legend-dot legend-selected\"></span>已选\r\n          </span>\r\n              <span class=\"legend-item\">\r\n            <span class=\"legend-dot legend-disabled\"></span>不可预约\r\n          </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"slot-grid\">\r\n            <button\r\n                v-for=\"slot in filteredTimeSlots\"\r\n                :key=\"slot.id\"\r\n                type=\"button\"\r\n                class=\"slot-item\"\r\n                :class=\"slotClass(slot)\"\r\n                :disabled=\"slotState(slot) === 'disabled'\"\r\n                @click=\"toggleSlot(slot)\"\r\n            >\r\n              <span class=\"slot-time\">{{ slot.label }}</span>\r\n              <span class=\"slot-range\">{{ slot.range }}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 已选时段 + 提交区域 -->\r\n        <div class=\"reserve-bottom\">\r\n          <div class=\"selected-tags\" v-if=\"selectedSlots.length\">\r\n            <div\r\n                v-for=\"item in selectedSlots\"\r\n                :key=\"item.key\"\r\n                class=\"selected-tag\"\r\n            >\r\n          <span class=\"selected-tag-text\">\r\n            {{ item.dateLabel }} · {{ currentVenueName }} · {{ item.slot.range }}\r\n          </span>\r\n              <button\r\n                  type=\"button\"\r\n                  class=\"selected-tag-close\"\r\n                  @click=\"removeSelected(item.key)\"\r\n              >\r\n                ×\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"reserve-actions\">\r\n            <button\r\n                type=\"button\"\r\n                class=\"link-btn\"\r\n                v-if=\"selectedSlots.length\"\r\n                @click=\"resetSelections\"\r\n            >\r\n              清空选择\r\n            </button>\r\n\r\n            <button\r\n                type=\"button\"\r\n                class=\"primary-btn reserve-btn\"\r\n                :disabled=\"!selectedSlots.length\"\r\n                @click=\"submitReservations\"\r\n            >\r\n              确认预约\r\n            </button>\r\n          </div>\r\n\r\n          <p class=\"hint-text\">\r\n            点击“确认预约”后会弹出当前选择的时段，并跳转到“我的预约”。\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 我的预约 -->\r\n    <div v-else-if=\"currentPage === 'user-reservations'\">\r\n      <div class=\"card card-reservations\">\r\n        <h2 class=\"page-title\">预约与签到签退</h2>\r\n        <div class=\"table-wrapper\">\r\n          <table class=\"table\">\r\n            <thead>\r\n            <tr>\r\n              <th>预约编号</th>\r\n              <th>自习室</th>\r\n              <th>日期</th>\r\n              <th>时间段</th>\r\n              <th>座位号</th>\r\n              <th>状态</th>\r\n              <th style=\"text-align: right;\">操作</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr\r\n                v-for=\"item in pagedReservations\"\r\n                :key=\"item.id\"\r\n            >\r\n              <td>{{ item.reservationNo }}</td>\r\n              <td>{{ item.roomName }}</td>\r\n              <td>{{ item.date }}</td>\r\n              <td>{{ formatTimeRange(item) }}</td>\r\n              <td>{{ item.seatLabel || '-' }}</td>\r\n              <td>\r\n      <span\r\n          class=\"badge\"\r\n          :class=\"statusClass(item.status)\"\r\n      >\r\n        {{ renderStatusText(item.status) }}\r\n      </span>\r\n              </td>\r\n              <td class=\"text-right\">\r\n                <!-- 签到 / 取消 只在待签到状态显示 -->\r\n                <button\r\n                    class=\"link-btn\"\r\n                    v-if=\"item.status === 'reserved'\"\r\n                    type=\"button\"\r\n                    @click=\"handleCheckIn(item)\"\r\n                >\r\n                  签到\r\n                </button>\r\n                <button\r\n                    class=\"link-btn link-danger\"\r\n                    v-if=\"item.status === 'reserved'\"\r\n                    type=\"button\"\r\n                    :disabled=\"!canCancel(item)\"\r\n                    @click=\"handleCancel(item)\"\r\n                >\r\n                  取消\r\n                </button>\r\n\r\n                <!-- 其它状态先暂时不操作，后面再做评价之类 -->\r\n                <button\r\n                    class=\"link-btn\"\r\n                    v-if=\"item.status === 'checked_in' || item.status === 'late'\"\r\n                    type=\"button\"\r\n                    disabled\r\n                >\r\n                  已签到\r\n                </button>\r\n                <button\r\n                    class=\"link-btn\"\r\n                    v-if=\"item.status === 'no_show'\"\r\n                    type=\"button\"\r\n                    disabled\r\n                >\r\n                  已过期\r\n                </button>\r\n                <button\r\n                    class=\"link-btn\"\r\n                    v-if=\"item.status === 'cancelled'\"\r\n                    type=\"button\"\r\n                    disabled\r\n                >\r\n                  不可操作\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <!-- 没有任何预约时的占位行 -->\r\n            <tr v-if=\"!myReservations.length\">\r\n              <td colspan=\"7\" style=\"text-align: center; color: #9ca3af; padding: 16px 0;\">\r\n                暂无预约记录\r\n              </td>\r\n            </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <!-- ⭐ 分页条：只有当总数 > 15 时才出现 -->\r\n        <div class=\"pager\" v-if=\"totalPages > 1\">\r\n          <!-- 上一页 -->\r\n          <button\r\n              type=\"button\"\r\n              class=\"pager-btn\"\r\n              :class=\"{ 'pager-btn-disabled': reservationPageIndex <= 1 }\"\r\n              :disabled=\"reservationPageIndex <= 1\"\r\n              @click=\"gotoPrevPage\"\r\n          >\r\n            上一页\r\n          </button>\r\n\r\n          <!-- 中间页码 -->\r\n          <div class=\"pager-center\">\r\n            第 {{ reservationPageIndex }} / {{ totalPages }} 页\r\n          </div>\r\n\r\n          <!-- 下一页 -->\r\n          <button\r\n              type=\"button\"\r\n              class=\"pager-btn\"\r\n              :class=\"{ 'pager-btn-disabled': reservationPageIndex >= totalPages }\"\r\n              :disabled=\"reservationPageIndex >= totalPages\"\r\n              @click=\"gotoNextPage\"\r\n          >\r\n            下一页\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 违规记录 -->\r\n    <div v-else-if=\"currentPage === 'user-violations'\">\r\n      <div class=\"card\">\r\n        <h2 class=\"page-title\">违规记录与信用分</h2>\r\n        <p class=\"page-subtitle\">\r\n          信用分从 100 开始，迟到、缺席、早退等行为会扣分。以下为示意数据。\r\n        </p>\r\n\r\n        <div class=\"credit-summary\">\r\n          <div class=\"credit-score\">\r\n            当前信用分：<span class=\"score-number\">96</span>\r\n          </div>\r\n          <p class=\"hint-text\">\r\n            信用分低于 60 可能会被列入黑名单，一段时间内无法预约。\r\n          </p>\r\n        </div>\r\n\r\n        <div class=\"table-wrapper\">\r\n          <table class=\"table\">\r\n            <thead>\r\n            <tr>\r\n              <th>日期</th>\r\n              <th>自习室</th>\r\n              <th>违规类型</th>\r\n              <th>扣分</th>\r\n              <th>备注</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr>\r\n              <td>2025-11-30</td>\r\n              <td>本部 · 图书馆 3 楼 301</td>\r\n              <td>未签到</td>\r\n              <td>-2</td>\r\n              <td>预约后未按时签到</td>\r\n            </tr>\r\n            <tr>\r\n              <td>2025-11-20</td>\r\n              <td>本部 · 图书馆 4 楼 401</td>\r\n              <td>早退</td>\r\n              <td>-1</td>\r\n              <td>提前 40 分钟离开</td>\r\n            </tr>\r\n            <tr>\r\n              <td>2025-10-02</td>\r\n              <td>东校区 · 教学楼 2 楼 203</td>\r\n              <td>占座</td>\r\n              <td>-1</td>\r\n              <td>长时间离开座位未释放</td>\r\n            </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 评价与投诉 -->\r\n    <div v-else-if=\"currentPage === 'user-feedback'\">\r\n      <div class=\"card\">\r\n        <h2 class=\"page-title\">评价与投诉</h2>\r\n        <p class=\"page-subtitle\">\r\n          可以对自习环境、规则执行情况进行评价，也可以提交投诉信息（示意表单）。\r\n        </p>\r\n\r\n        <div class=\"feedback-grid\">\r\n          <div class=\"feedback-column\">\r\n            <h3 class=\"section-title\">快速评价</h3>\r\n            <textarea\r\n                class=\"textarea\"\r\n                rows=\"4\"\r\n                placeholder=\"例如：环境安静、卫生良好、管理员服务态度不错等。\"\r\n            ></textarea>\r\n            <button class=\"primary-btn\">提交评价</button>\r\n          </div>\r\n          <div class=\"feedback-column\">\r\n            <h3 class=\"section-title\">投诉 / 建议</h3>\r\n            <textarea\r\n                class=\"textarea\"\r\n                rows=\"4\"\r\n                placeholder=\"请详细描述问题：发生时间、地点、涉及人员、具体情况等，以便管理员跟进处理。\"\r\n            ></textarea>\r\n            <button class=\"primary-btn\">提交投诉</button>\r\n          </div>\r\n        </div>\r\n\r\n        <p class=\"hint-text\">\r\n          示例页面不会真正发送数据到后端，接入接口后，按钮可触发实际提交逻辑。\r\n        </p>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 个人中心 -->\r\n    <div v-else-if=\"currentPage === 'user-profile'\">\r\n      <div class=\"card\">\r\n        <h2 class=\"page-title\">个人中心</h2>\r\n        <p class=\"page-subtitle\">\r\n          查看并维护个人基础信息，建议与学校学工系统保持一致，信息发生变动时及时更新。\r\n        </p>\r\n\r\n        <div class=\"profile-form\">\r\n          <div class=\"form-row\">\r\n            <div class=\"form-item\">\r\n              <label>姓名</label>\r\n              <input type=\"text\" value=\"张三\" />\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <label>学号</label>\r\n              <input type=\"text\" value=\"2023001234\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <div class=\"form-item\">\r\n              <label>学院</label>\r\n              <input type=\"text\" value=\"计算机学院\" />\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <label>年级与班级</label>\r\n              <input type=\"text\" value=\"大三 · 计科 3 班\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <div class=\"form-item\">\r\n              <label>手机号</label>\r\n              <input type=\"text\" value=\"138****1234\" />\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <label>邮箱</label>\r\n              <input type=\"email\" value=\"student@example.com\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <div class=\"form-item\">\r\n              <label>常用校区</label>\r\n              <select>\r\n                <option>本部</option>\r\n                <option>东校区</option>\r\n              </select>\r\n            </div>\r\n            <div class=\"form-item\">\r\n              <label>备注</label>\r\n              <input type=\"text\" placeholder=\"例如：偏好图书馆、晚上时段较多等\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"profile-actions\">\r\n            <button class=\"primary-btn\" type=\"button\">保存信息</button>\r\n            <span class=\"hint-text\">\r\n              示意按钮，接入接口后可更新数据库中的用户信息。\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'AppHome',\r\n  props: {\r\n    currentPage: {\r\n      type: String,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['change-page'],\r\n  data () {\r\n    return {\r\n      // 场地（地点）列表\r\n      reserveVenues: ['本部 · 图书馆 301', '本部 · 图书馆 401', '东校区 · 教学楼 3 楼'],\r\n      reserveVenueIndex: 0,\r\n\r\n      // 日期相关\r\n      dateList: [],\r\n      visibleStart: 0,\r\n      visibleCount: 7, // 一屏展示多少天\r\n      currentDateIndex: 0,\r\n\r\n      // 时间段列表（0 点~24 点）\r\n      timeSlots: [],\r\n\r\n      // 后端返回的“已满时段”（id 列表，例如 [8,9,14]）\r\n      disabledSlotIds: [],\r\n\r\n      // 已选时段（最多 4 个）\r\n      selectedSlots: [],\r\n\r\n      // 是否只展示“可预约”的时段\r\n      onlyShowAvailable: false,\r\n\r\n      // 房间 id 映射（按顺序和 reserveVenues 对应）\r\n      roomIds: [1, 2, 3], // 换成你 room 表里的真实 id\r\n\r\n      // 当前登录用户 id（从登录时存的用户信息里读）\r\n      currentUserId: null,\r\n\r\n      // 我的预约列表\r\n      myReservations: [],\r\n\r\n      // 我的预约分页\r\n      pageSize: 15,\r\n      reservationPageIndex: 1,\r\n    }\r\n  },\r\n  computed: {\r\n    visibleDates () {\r\n      return this.dateList\r\n          .slice(this.visibleStart, this.visibleStart + this.visibleCount)\r\n          .map((d, idx) => ({\r\n            ...d,\r\n            index: this.visibleStart + idx\r\n          }))\r\n    },\r\n    canMovePrev () {\r\n      return this.visibleStart > 0\r\n    },\r\n    canMoveNext () {\r\n      return this.visibleStart + this.visibleCount < this.dateList.length\r\n    },\r\n    currentVenueName () {\r\n      return this.reserveVenues[this.reserveVenueIndex] || ''\r\n    },\r\n    // 当前选中的日期完整文本（用于右侧概要）\r\n    currentDateLabel () {\r\n      const cur = this.dateList[this.currentDateIndex]\r\n      return cur ? cur.fullLabel : ''\r\n    },\r\n    // 根据开关过滤时间段列表\r\n    filteredTimeSlots () {\r\n      if (!this.onlyShowAvailable) {\r\n        return this.timeSlots\r\n      }\r\n      // 只展示“可预约”的时段\r\n      return this.timeSlots.filter(slot => this.slotState(slot) === 'available')\r\n    },\r\n    // 当前房间 id\r\n    currentRoomId () {\r\n      return this.roomIds[this.reserveVenueIndex]\r\n    },\r\n    // 后端需要 yyyy-MM-dd 格式的日期字符串\r\n    currentDateStr () {\r\n      const cur = this.dateList[this.currentDateIndex]\r\n      // 我们在 initDates 里已经生成了 fullLabel = '2025-12-13'\r\n      return cur ? cur.fullLabel : null\r\n    },\r\n    // 总页数\r\n    totalPages () {\r\n      if (!this.myReservations.length) return 0\r\n      return Math.ceil(this.myReservations.length / this.pageSize)\r\n    },\r\n    // 当前页要展示的 15 条\r\n    pagedReservations () {\r\n      if (!this.myReservations.length) return []\r\n      const total = this.totalPages || 1\r\n      const page = Math.min(this.reservationPageIndex, total)\r\n      const start = (page - 1) * this.pageSize\r\n      const end = start + this.pageSize\r\n      return this.myReservations.slice(start, end)\r\n    },\r\n  },\r\n  created () {\r\n    // 初始化时间段、日期\r\n    this.timeSlots = this.buildTimeSlots()\r\n    this.initDates()\r\n\r\n    // 读取当前登录用户：从 localStorage 的 ssrmsUser 里取\r\n    const raw = localStorage.getItem('ssrmsUser')\r\n    if (raw) {\r\n      try {\r\n        const user = JSON.parse(raw)\r\n        this.currentUserId = user.id   // 如果你的主键不是 id，而是 userId，就改成 user.userId\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n    }\r\n\r\n    // 初始化完后拉一次当天的占用情况\r\n    this.fetchSlotStatus()\r\n  },\r\n  methods: {\r\n    emitChange (page) {\r\n      this.$emit('change-page', page)\r\n    },\r\n\r\n    // 点击场地 tab\r\n    handleVenueClick (index) {\r\n      this.reserveVenueIndex = index\r\n      this.fetchSlotStatus()\r\n    },\r\n\r\n    // 构造 24 个时间段（0-1 点，1-2 点...）\r\n    buildTimeSlots () {\r\n      const list = []\r\n      for (let h = 0; h < 24; h++) {\r\n        const next = (h + 1) % 24\r\n        const id = String(h)\r\n        const range =\r\n            `${h.toString().padStart(2, '0')}:00 - ` +\r\n            `${next.toString().padStart(2, '0')}:00`\r\n        const label =\r\n            (h % 12 === 0 ? 12 : h % 12) +\r\n            ': 00 ' +\r\n            (h < 12 ? 'AM' : 'PM')\r\n        list.push({\r\n          id,\r\n          label,\r\n          range\r\n        })\r\n      }\r\n      return list\r\n    },\r\n\r\n    // 生成接下来 14 天的日期条\r\n    initDates () {\r\n      const today = new Date()\r\n      const list = []\r\n      const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\r\n      for (let i = 0; i < 14; i++) {\r\n        const d = new Date(today)\r\n        d.setDate(d.getDate() + i)\r\n        const month = d.getMonth() + 1\r\n        const day = d.getDate()\r\n        const fullLabel =\r\n            `${d.getFullYear()}-${month.toString().padStart(2, '0')}-` +\r\n            `${day.toString().padStart(2, '0')}`\r\n        list.push({\r\n          key: i,\r\n          year: d.getFullYear(),\r\n          month,\r\n          day,\r\n          weekday: weekdays[d.getDay()],\r\n          monthLabel: `${d.getFullYear()}-${month.toString().padStart(2, '0')}`,\r\n          isToday: i === 0,\r\n          isTomorrow: i === 1,\r\n          fullLabel\r\n        })\r\n      }\r\n      this.dateList = list\r\n      this.visibleStart = 0\r\n      this.currentDateIndex = 0\r\n    },\r\n\r\n    moveDates (direction) {\r\n      if (direction === 'prev' && this.canMovePrev) {\r\n        this.visibleStart -= 1\r\n      } else if (direction === 'next' && this.canMoveNext) {\r\n        this.visibleStart += 1\r\n      }\r\n    },\r\n\r\n    // 点击日期\r\n    selectDate (index) {\r\n      this.currentDateIndex = index\r\n      this.fetchSlotStatus()\r\n    },\r\n\r\n    buildKey (dateIndex, slotId) {\r\n      return `${dateIndex}-${slotId}`\r\n    },\r\n\r\n    // 当前时段是可预约 / 已选 / 不可预约\r\n    slotState (slot) {\r\n      if (this.disabledSlotIds.includes(slot.id)) {\r\n        return 'disabled'\r\n      }\r\n      const key = this.buildKey(this.currentDateIndex, slot.id)\r\n      const exists = this.selectedSlots.some(item => item.key === key)\r\n      if (exists) {\r\n        return 'selected'\r\n      }\r\n      return 'available'\r\n    },\r\n\r\n    slotClass (slot) {\r\n      const state = this.slotState(slot)\r\n      return {\r\n        'slot-available': state === 'available',\r\n        'slot-disabled': state === 'disabled',\r\n        'slot-selected': state === 'selected'\r\n      }\r\n    },\r\n\r\n    // 点击时段：选中 / 取消\r\n    toggleSlot (slot) {\r\n      if (this.slotState(slot) === 'disabled') {\r\n        return\r\n      }\r\n      const key = this.buildKey(this.currentDateIndex, slot.id)\r\n      const index = this.selectedSlots.findIndex(item => item.key === key)\r\n      if (index !== -1) {\r\n        this.selectedSlots.splice(index, 1)\r\n        return\r\n      }\r\n      if (this.selectedSlots.length >= 4) {\r\n        alert('最多只能选择 4 个预约时段')\r\n        return\r\n      }\r\n      const dateInfo = this.dateList[this.currentDateIndex]\r\n      const dateLabel = dateInfo.fullLabel\r\n      this.selectedSlots.push({\r\n        key,\r\n        dateIndex: this.currentDateIndex,\r\n        dateLabel,\r\n        slot\r\n      })\r\n    },\r\n\r\n    removeSelected (key) {\r\n      const index = this.selectedSlots.findIndex(item => item.key === key)\r\n      if (index !== -1) {\r\n        this.selectedSlots.splice(index, 1)\r\n      }\r\n    },\r\n\r\n    resetSelections () {\r\n      this.selectedSlots = []\r\n    },\r\n\r\n    // 提交预约：调用后端 /reservation/create\r\n    async submitReservations () {\r\n      if (!this.selectedSlots.length) return\r\n\r\n      if (!this.currentUserId) {\r\n        alert('请先登录后再预约')\r\n        return\r\n      }\r\n\r\n      const slotIds = this.selectedSlots.map(item => Number(item.slot.id))\r\n\r\n      try {\r\n        const resp = await this.$axios.post('/reservation/create', {\r\n          userId: this.currentUserId, // 先直接传，之后可以改成后端从登录态获取\r\n          roomId: this.currentRoomId,\r\n          date: this.currentDateStr,\r\n          slotIds\r\n        })\r\n\r\n        const result = resp.data\r\n        if (result.code && result.code !== 200) {\r\n          alert(result.msg || '预约失败')\r\n          return\r\n        }\r\n\r\n        alert('预约成功')\r\n        // 清空选择\r\n        this.selectedSlots = []\r\n        // 重新拉一遍时段状态，刷新灰色/可选状态\r\n        await this.fetchSlotStatus()\r\n        // 保留原来的行为：预约后跳到“我的预约”\r\n        this.emitChange('user-reservations')\r\n      } catch (e) {\r\n        console.error(e)\r\n        alert('预约失败，服务器异常')\r\n      }\r\n    },\r\n\r\n    // 从后端拉取某房间某天的“已满时段”\r\n    async fetchSlotStatus () {\r\n      // 房间或日期还没准备好就先不调\r\n      if (!this.currentRoomId || !this.currentDateStr) return\r\n\r\n      try {\r\n        const resp = await this.$axios.get('/reservation/slots', {\r\n          params: {\r\n            roomId: this.currentRoomId,\r\n            date: this.currentDateStr\r\n          }\r\n        })\r\n\r\n        const result = resp.data\r\n        const dto = result.data || {}\r\n        // 后端返回的是 [8,9,14] 这样，我们前端用字符串 id\r\n        this.disabledSlotIds = (dto.disabledSlotIds || []).map(id => String(id))\r\n      } catch (e) {\r\n        console.error(e)\r\n        alert('获取时段状态失败')\r\n      }\r\n    },\r\n\r\n    // 把后端返回的预约列表加载到表格\r\n    async loadMyReservations () {\r\n      // 确保有 currentUserId，没有的话再尝试从 localStorage 读一次\r\n      if (!this.currentUserId) {\r\n        const raw = localStorage.getItem('ssrmsUser')\r\n        if (raw) {\r\n          try {\r\n            const user = JSON.parse(raw)\r\n            this.currentUserId = user.id   // 如果主键叫 userId，就改成 user.userId\r\n          } catch (e) {\r\n            console.error(e)\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!this.currentUserId) return\r\n\r\n      try {\r\n        const resp = await this.$axios.get('/reservation/my', {\r\n          params: { userId: this.currentUserId }\r\n        })\r\n        const result = resp.data\r\n        const list = Array.isArray(result.data) ? result.data.slice() : []\r\n\r\n        // 前端排序：日期倒序（新→旧），同一天按开始时间升序\r\n        list.sort((a, b) => {\r\n          const da = a.date || ''\r\n          const db = b.date || ''\r\n          if (da !== db) {\r\n            // 倒序：大的在前\r\n            return db.localeCompare(da)\r\n          }\r\n          const ta = a.startTime || ''\r\n          const tb = b.startTime || ''\r\n          return ta.localeCompare(tb)\r\n        })\r\n\r\n        this.myReservations = list\r\n      } catch (e) {\r\n        console.error(e)\r\n        alert('加载预约列表失败')\r\n      }\r\n    },\r\n\r\n    // 把 startTime / endTime 拼成 “HH:mm-HH:mm”\r\n    formatTimeRange (item) {\r\n      const s = (item.startTime || '').slice(0, 5)\r\n      const e = (item.endTime || '').slice(0, 5)\r\n      return s && e ? `${s}-${e}` : ''\r\n    },\r\n\r\n    // 把后端状态英文转成中文文案\r\n    renderStatusText (status) {\r\n      switch (status) {\r\n        case 'reserved':\r\n          return '待签到'\r\n        case 'checked_in':\r\n          return '已签到'\r\n        case 'late':\r\n          return '迟到'\r\n        case 'no_show':\r\n          return '未签到'\r\n        case 'cancelled':\r\n          return '已取消'\r\n        default:\r\n          return status || ''\r\n      }\r\n    },\r\n\r\n    // 根据状态决定徽标颜色（先留好钩子，样式后面想美化再改）\r\n    statusClass (status) {\r\n      return {\r\n        'badge-pending': status === 'reserved',\r\n        'badge-done': status === 'checked_in',\r\n        'badge-late': status === 'late',\r\n        'badge-missed': status === 'no_show',\r\n        'badge-cancelled': status === 'cancelled'\r\n      }\r\n    },\r\n\r\n    gotoPrevPage () {\r\n      if (this.reservationPageIndex > 1) {\r\n        this.reservationPageIndex--\r\n      }\r\n    },\r\n\r\n    gotoNextPage () {\r\n      if (this.reservationPageIndex < this.totalPages) {\r\n        this.reservationPageIndex++\r\n      }\r\n    },\r\n\r\n    // 签到\r\n    async handleCheckIn (item) {\r\n      try {\r\n        const resp = await this.$axios.post(`/reservation/checkin/${item.id}`)\r\n        const result = resp.data\r\n        if (result.code && result.code !== 200) {\r\n          alert(result.msg || '签到失败')\r\n          return\r\n        }\r\n        alert(result.msg || '签到成功')\r\n        // 重新刷新列表和占用情况\r\n        await this.loadMyReservations()\r\n        // 如果你希望“我要预约”那边也立即刷新占用，可以顺带：\r\n        // await this.fetchSlotStatus()\r\n      } catch (e) {\r\n        console.error(e)\r\n        alert('签到失败，服务器异常')\r\n      }\r\n    },\r\n\r\n    // 取消占位，后面再实现\r\n    async handleCancel (item) {\r\n      // 前端再保险一次 10 分钟规则\r\n      if (!this.canCancel(item)) {\r\n        alert('距离开始不足 10 分钟，无法取消，请联系管理员处理')\r\n        return\r\n      }\r\n\r\n      const ok = window.confirm(`确定要取消本次预约（${item.date} ${this.formatTimeRange(item)}）吗？`)\r\n      if (!ok) {\r\n        return\r\n      }\r\n\r\n      try {\r\n        const resp = await this.$axios.post(`/reservation/cancel/${item.id}`)\r\n        const result = resp.data || {}\r\n\r\n        if (result.code && result.code !== 200) {\r\n          alert(result.msg || '取消失败')\r\n          return\r\n        }\r\n\r\n        alert(result.msg || '取消成功')\r\n        // 重新加载预约列表\r\n        await this.loadMyReservations()\r\n        // 同时刷新一下“我要预约”那边的占用情况（释放座位）\r\n        await this.fetchSlotStatus()\r\n      } catch (e) {\r\n        console.error(e)\r\n        alert('取消失败，服务器异常')\r\n      }\r\n    },\r\n    // 是否还允许取消：只在开始时间 10 分钟前才允许\r\n    canCancel (item) {\r\n      if (item.status !== 'reserved') return false\r\n      if (!item.date || !item.startTime) return false\r\n\r\n      try {\r\n        // 后端传来的格式大概率是：date = '2025-12-22', startTime = '01:00:00'\r\n        const startStr = item.date + 'T' + (item.startTime || '').slice(0, 8)\r\n        const start = new Date(startStr)\r\n        if (isNaN(start.getTime())) {\r\n          // 解析失败就不在前端拦，交给后端判断\r\n          return true\r\n        }\r\n        const now = new Date()\r\n        const diffMs = start.getTime() - now.getTime()\r\n        const tenMinutes = 10 * 60 * 1000\r\n        // diffMs > 10 分钟 ⇒ 可以取消\r\n        return diffMs > tenMinutes\r\n      } catch (e) {\r\n        console.error(e)\r\n        // 出异常直接放行，交给后端\r\n        return true\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    currentPage (newVal) {\r\n      if (newVal === 'user-reservations') {\r\n        this.loadMyReservations()\r\n      }\r\n      if (newVal === 'user-reserve') {\r\n        this.fetchSlotStatus()\r\n      }\r\n    },\r\n    myReservations () {\r\n      // 每次重新加载列表，从第 1 页开始\r\n      this.reservationPageIndex = 1\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.main {\r\n  flex: 1;\r\n  padding: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n/* 首页外层容器，拉满右侧高度 */\r\n.home-wrapper {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n/* 通用卡片样式 */\r\n.card {\r\n  background-color: #ffffff;\r\n  padding: 22px 24px;\r\n  margin-bottom: 16px;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);\r\n  border: 1px solid #e5e7eb;\r\n}\r\n\r\n/* 首页这张大卡片要撑满高度 */\r\n.home-card {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-bottom: 0;\r\n}\r\n\r\n.page-title {\r\n  font-size: 24px;\r\n  margin: 0 0 10px 0;\r\n  color: #111827;\r\n}\r\n\r\n.page-subtitle {\r\n  font-size: 15px;\r\n  color: #6b7280;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n/* 首页上半部分：欢迎文案 */\r\n.home-top {\r\n  display: flex;\r\n  align-items: stretch;\r\n  gap: 24px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.home-intro {\r\n  flex: 1.3;\r\n}\r\n\r\n.overview-wrapper {\r\n  margin-top: 8px;\r\n}\r\n\r\n.home-tagline {\r\n  font-size: 13px;\r\n  color: #4b5563;\r\n  margin-top: 6px;\r\n}\r\n.home-tagline strong {\r\n  color: #2563eb;\r\n}\r\n\r\n/* 今日概况卡片：统一为白色卡片背景 */\r\n.home-panel {\r\n  border-radius: 12px;\r\n  padding: 16px 18px;\r\n  background-color: #ffffff;\r\n  border: 1px solid #e5e7eb;\r\n  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.04);\r\n  color: #111827;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n}\r\n\r\n.home-panel-title {\r\n  font-size: 14px;\r\n  opacity: 0.9;\r\n}\r\n\r\n.home-panel-number {\r\n  font-size: 26px;\r\n  font-weight: 600;\r\n  margin: 6px 0 2px;\r\n}\r\n\r\n.home-panel-desc {\r\n  font-size: 13px;\r\n  opacity: 0.95;\r\n}\r\n\r\n.home-panel-footer {\r\n  font-size: 12px;\r\n  opacity: 0.88;\r\n  margin-top: 8px;\r\n}\r\n.home-panel-footer span {\r\n  font-weight: 500;\r\n}\r\n\r\n/* 我要预约页面 */\r\n.reserve-card {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.reserve-header {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.venue-tabs {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.venue-tab {\r\n  border-radius: 999px;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  padding: 6px 16px;\r\n  font-size: 13px;\r\n  cursor: pointer;\r\n  color: #4b5563;\r\n}\r\n.venue-tab.active {\r\n  background-color: #eef2ff;\r\n  border-color: #6366f1;\r\n  color: #3730a3;\r\n  font-weight: 600;\r\n}\r\n\r\n.date-strip {\r\n  display: flex;\r\n  align-items: stretch;\r\n  gap: 8px;\r\n}\r\n\r\n.date-arrow {\r\n  border-radius: 8px;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  width: 32px;\r\n  font-size: 18px;\r\n  cursor: pointer;\r\n}\r\n.date-arrow:disabled {\r\n  opacity: 0.4;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.date-list {\r\n  flex: 1;\r\n  display: flex;\r\n  overflow-x: auto;\r\n  gap: 8px;\r\n}\r\n\r\n.date-item {\r\n  min-width: 110px;\r\n  border-radius: 10px;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  padding: 6px 10px;\r\n  text-align: left;\r\n  font-size: 12px;\r\n  cursor: pointer;\r\n  color: #4b5563;\r\n}\r\n.date-item.active {\r\n  border-color: #6366f1;\r\n  background-color: #eef2ff;\r\n  color: #3730a3;\r\n}\r\n\r\n.date-month {\r\n  font-size: 11px;\r\n  opacity: 0.8;\r\n}\r\n\r\n.date-day-row {\r\n  display: flex;\r\n  align-items: baseline;\r\n  gap: 6px;\r\n}\r\n\r\n.date-day-number {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n}\r\n\r\n.date-weekday {\r\n  font-size: 12px;\r\n}\r\n\r\n.date-extra {\r\n  font-size: 11px;\r\n  color: #2563eb;\r\n  margin-top: 2px;\r\n}\r\n\r\n.reserve-legend {\r\n  margin-top: 8px;\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n  display: flex;\r\n  gap: 16px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.legend-item {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n.legend-dot {\r\n  width: 12px;\r\n  height: 6px;\r\n  border-radius: 6px;\r\n}\r\n\r\n.legend-available {\r\n  background-color: #bbf7d0;\r\n}\r\n.legend-disabled {\r\n  background-color: #e5e7eb;\r\n}\r\n.legend-selected {\r\n  background-color: #bfdbfe;\r\n}\r\n\r\n/* 时段卡片 */\r\n.slot-grid {\r\n  margin-top: 12px;\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n  gap: 10px;\r\n}\r\n\r\n.slot-item {\r\n  border-radius: 10px;\r\n  border: 1px solid #e5e7eb;\r\n  padding: 10px 8px;\r\n  text-align: left;\r\n  font-size: 12px;\r\n  cursor: pointer;\r\n  background-color: #f9fafb;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n\r\n.slot-time {\r\n  font-size: 13px;\r\n  margin-bottom: 4px;\r\n}\r\n.slot-range {\r\n  font-size: 11px;\r\n  color: #6b7280;\r\n}\r\n\r\n.slot-available {\r\n  background-color: #f9fafb;\r\n}\r\n\r\n.slot-disabled {\r\n  background-color: #e5e7eb;\r\n  color: #9ca3af;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.slot-selected {\r\n  background-color: #4f46e5;\r\n  color: #ffffff;\r\n  border-color: #4338ca;\r\n}\r\n.slot-selected .slot-range {\r\n  color: #e0e7ff;\r\n}\r\n\r\n.reserve-bottom {\r\n  margin-top: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.selected-tags {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n}\r\n\r\n.selected-tag {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  border-radius: 8px;\r\n  background-color: #e0e7ff;\r\n  padding: 6px 8px;\r\n  font-size: 12px;\r\n  color: #3730a3;\r\n}\r\n\r\n.selected-tag-main {\r\n  margin-right: 4px;\r\n}\r\n\r\n.selected-tag-close {\r\n  border: none;\r\n  background: transparent;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  color: #4b5563;\r\n}\r\n\r\n.reserve-submit {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n/* 公共表格样式 */\r\n\r\n.table-wrapper {\r\n  margin-top: 12px;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n  border: 1px solid #e5e7eb;\r\n}\r\n\r\n.table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 13px;\r\n}\r\n\r\n.table th,\r\n.table td {\r\n  padding: 10px 12px;\r\n  border-bottom: 1px solid #e5e7eb;\r\n}\r\n\r\n.table th {\r\n  background-color: #f3f4f6;\r\n  text-align: left;\r\n  font-weight: 600;\r\n  color: #374151;\r\n}\r\n\r\n.table tr:nth-child(even) td {\r\n  background-color: #f9fafb;\r\n}\r\n\r\n.text-right {\r\n  text-align: right;\r\n}\r\n\r\n.link-btn {\r\n  border: none;\r\n  background: transparent;\r\n  color: #2563eb;\r\n  font-size: 13px;\r\n  cursor: pointer;\r\n  margin-left: 6px;\r\n}\r\n\r\n.link-btn[disabled] {\r\n  color: #9ca3af;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.link-danger {\r\n  color: #dc2626;\r\n}\r\n\r\n/* 信用分 */\r\n\r\n.credit-summary {\r\n  margin-top: 6px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.credit-score {\r\n  font-size: 15px;\r\n  color: #111827;\r\n}\r\n\r\n.score-number {\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: #16a34a;\r\n}\r\n\r\n/* 评价与投诉 */\r\n\r\n.feedback-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\r\n  gap: 16px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.feedback-column {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.section-title {\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.textarea {\r\n  border-radius: 10px;\r\n  border: 1px solid #d1d5db;\r\n  padding: 8px 10px;\r\n  resize: vertical;\r\n  font-size: 13px;\r\n}\r\n\r\n/* 个人中心 */\r\n\r\n.profile-form {\r\n  margin-top: 12px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n\r\n.form-row {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\r\n  gap: 12px;\r\n}\r\n\r\n.form-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 13px;\r\n}\r\n\r\n.form-item label {\r\n  margin-bottom: 4px;\r\n  color: #4b5563;\r\n}\r\n\r\n.form-item input,\r\n.form-item select {\r\n  border-radius: 8px;\r\n  border: 1px solid #d1d5db;\r\n  padding: 6px 10px;\r\n  font-size: 13px;\r\n  outline: none;\r\n}\r\n\r\n.form-item input:focus,\r\n.form-item select:focus {\r\n  border-color: #2563eb;\r\n}\r\n\r\n.profile-actions {\r\n  margin-top: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n/* 通用按钮和提示 */\r\n\r\n.primary-btn {\r\n  padding: 8px 18px;\r\n  border-radius: 999px;\r\n  border: none;\r\n  outline: none;\r\n  background-color: #2563eb;\r\n  color: #ffffff;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n}\r\n\r\n.primary-btn:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.badge {\r\n  display: inline-block;\r\n  padding: 2px 8px;\r\n  border-radius: 999px;\r\n  font-size: 11px;\r\n  background-color: #e0e7ff;\r\n  color: #3730a3;\r\n}\r\n\r\n.hint-text {\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n  margin-top: 8px;\r\n}\r\n\r\n/* ===========================\r\n   我要预约页面样式（美化）\r\n   =========================== */\r\n\r\n.reserve-card {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 18px;\r\n}\r\n\r\n/* 顶部：标题 + 概要卡片 */\r\n.reserve-header-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: 24px;\r\n  align-items: flex-start;\r\n}\r\n\r\n.reserve-header-left {\r\n  flex: 1;\r\n}\r\n\r\n.reserve-summary-box {\r\n  width: 260px;\r\n  padding: 12px 14px;\r\n  border-radius: 14px;\r\n  background: linear-gradient(135deg, #eef2ff, #f5f7ff);\r\n  border: 1px solid #e0e7ff;\r\n  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.04);\r\n  font-size: 13px;\r\n}\r\n\r\n.summary-title {\r\n  font-weight: 600;\r\n  color: #111827;\r\n  margin-bottom: 6px;\r\n}\r\n\r\n.summary-main {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n.summary-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.summary-label {\r\n  color: #6b7280;\r\n}\r\n\r\n.summary-value {\r\n  color: #111827;\r\n  font-weight: 500;\r\n  text-align: right;\r\n}\r\n\r\n.summary-empty {\r\n  color: #9ca3af;\r\n  font-weight: 400;\r\n}\r\n\r\n/* 场地 tabs + 开关 */\r\n.reserve-toolbar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  gap: 16px;\r\n  margin-top: 2px;\r\n}\r\n\r\n.venue-tabs {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n}\r\n\r\n.venue-tab {\r\n  padding: 6px 14px;\r\n  border-radius: 999px;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #fff;\r\n  font-size: 13px;\r\n  color: #374151;\r\n  cursor: pointer;\r\n  transition: all 0.15s ease;\r\n}\r\n\r\n.venue-tab:hover {\r\n  border-color: #93c5fd;\r\n  background-color: #eff6ff;\r\n}\r\n\r\n.venue-tab.active {\r\n  border-color: #2563eb;\r\n  background: linear-gradient(135deg, #2563eb, #4f46e5);\r\n  color: #fff;\r\n  box-shadow: 0 6px 14px rgba(37, 99, 235, 0.25);\r\n}\r\n\r\n.reserve-toolbar-right {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n}\r\n\r\n.switch-label {\r\n  white-space: nowrap;\r\n}\r\n\r\n/* 日期条 */\r\n.date-strip {\r\n  margin-top: 6px;\r\n  padding: 10px 12px;\r\n  border-radius: 14px;\r\n  background-color: #f9fafb;\r\n  display: flex;\r\n  align-items: stretch;\r\n  gap: 8px;\r\n}\r\n\r\n.date-arrow {\r\n  width: 32px;\r\n  border-radius: 10px;\r\n  border: none;\r\n  background-color: #fff;\r\n  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);\r\n  font-size: 18px;\r\n  color: #4b5563;\r\n  cursor: pointer;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.date-arrow:disabled {\r\n  opacity: 0.4;\r\n  cursor: default;\r\n  box-shadow: none;\r\n}\r\n\r\n.date-list {\r\n  display: flex;\r\n  gap: 8px;\r\n  flex: 1;\r\n}\r\n\r\n.date-item {\r\n  flex: 1;\r\n  min-width: 90px;\r\n  border-radius: 12px;\r\n  border: 1px solid transparent;\r\n  background-color: #fff;\r\n  padding: 8px 10px;\r\n  text-align: left;\r\n  cursor: pointer;\r\n  transition: all 0.15s ease;\r\n  height: 80px;\r\n}\r\n\r\n.date-item:hover {\r\n  border-color: #bfdbfe;\r\n  box-shadow: 0 3px 10px rgba(15, 23, 42, 0.06);\r\n}\r\n\r\n.date-item.active {\r\n  border-color: #2563eb;\r\n  background: linear-gradient(135deg, #2563eb, #4f46e5);\r\n  color: #fff;\r\n}\r\n\r\n.date-item.active .date-month,\r\n.date-item.active .date-weekday,\r\n.date-item.active .date-extra {\r\n  color: #e0ecff;\r\n}\r\n\r\n.date-item.active .date-day-number {\r\n  color: #fff;\r\n}\r\n\r\n.date-month {\r\n  font-size: 11px;\r\n  color: #6b7280;\r\n}\r\n\r\n.date-day-row {\r\n  display: flex;\r\n  align-items: baseline;\r\n  gap: 4px;\r\n  margin: 4px 0;\r\n}\r\n\r\n.date-day-number {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  color: #111827;\r\n}\r\n\r\n.date-weekday {\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n}\r\n\r\n.date-extra {\r\n  font-size: 11px;\r\n  color: #2563eb;\r\n}\r\n\r\n/* 时间段区域 */\r\n\r\n.slot-section {\r\n  margin-top: 16px;\r\n}\r\n\r\n.slot-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.slot-title {\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  color: #111827;\r\n}\r\n\r\n.slot-legend {\r\n  display: flex;\r\n  gap: 12px;\r\n  font-size: 11px;\r\n  color: #6b7280;\r\n}\r\n\r\n.legend-item {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n}\r\n\r\n.legend-dot {\r\n  width: 10px;\r\n  height: 10px;\r\n  border-radius: 999px;\r\n}\r\n\r\n.legend-available {\r\n  background-color: #e5f3ff;\r\n  border: 1px solid #93c5fd;\r\n}\r\n\r\n.legend-selected {\r\n  background-color: #2563eb;\r\n}\r\n\r\n.legend-disabled {\r\n  background-color: #e5e7eb;\r\n}\r\n\r\n.slot-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(4, minmax(0, 1fr));\r\n  gap: 10px;\r\n}\r\n\r\n.slot-item {\r\n  border-radius: 12px;\r\n  border: 1px solid #e5e7eb;\r\n  padding: 8px 10px;\r\n  background-color: #f9fafb;\r\n  text-align: left;\r\n  cursor: pointer;\r\n  transition: all 0.15s ease;\r\n}\r\n\r\n.slot-item:disabled {\r\n  cursor: not-allowed;\r\n}\r\n\r\n.slot-time {\r\n  font-size: 13px;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.slot-range {\r\n  font-size: 11px;\r\n  color: #6b7280;\r\n}\r\n\r\n/* 状态色 */\r\n.slot-available {\r\n  background-color: #f9fafb;\r\n}\r\n\r\n.slot-disabled {\r\n  background-color: #f3f4f6;\r\n  color: #9ca3af;\r\n  border-style: dashed;\r\n}\r\n\r\n.slot-selected {\r\n  background: linear-gradient(135deg, #2563eb, #4f46e5);\r\n  color: #fff;\r\n  border-color: transparent;\r\n  box-shadow: 0 6px 14px rgba(37, 99, 235, 0.25);\r\n}\r\n\r\n.slot-selected .slot-range {\r\n  color: #e0ecff;\r\n}\r\n\r\n/* 已选时段 + 提交区域 */\r\n\r\n.reserve-bottom {\r\n  margin-top: 16px;\r\n  border-top: 1px dashed #e5e7eb;\r\n  padding-top: 12px;\r\n}\r\n\r\n.selected-tags {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.selected-tag {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  border-radius: 999px;\r\n  background-color: #eff6ff;\r\n  padding: 4px 8px 4px 10px;\r\n  font-size: 11px;\r\n  color: #1f2937;\r\n}\r\n\r\n.selected-tag-close {\r\n  border: none;\r\n  background: none;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n}\r\n\r\n.selected-tag-close:hover {\r\n  color: #111827;\r\n}\r\n\r\n.reserve-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.link-btn {\r\n  border: none;\r\n  background: none;\r\n  font-size: 12px;\r\n  color: #6b7280;\r\n  cursor: pointer;\r\n  padding: 4px 8px;\r\n}\r\n\r\n.link-btn:hover {\r\n  color: #111827;\r\n  text-decoration: underline;\r\n}\r\n\r\n.reserve-btn {\r\n  padding: 8px 20px;\r\n}\r\n\r\n.primary-btn {\r\n  border: none;\r\n  border-radius: 999px;\r\n  background: linear-gradient(135deg, #2563eb, #4f46e5);\r\n  color: #fff;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  padding: 8px 18px;\r\n  box-shadow: 0 8px 18px rgba(37, 99, 235, 0.3);\r\n  transition: all 0.15s ease;\r\n}\r\n\r\n.primary-btn:disabled {\r\n  opacity: 0.4;\r\n  cursor: default;\r\n  box-shadow: none;\r\n}\r\n\r\n.primary-btn:not(:disabled):hover {\r\n  transform: translateY(-1px);\r\n  box-shadow: 0 10px 22px rgba(37, 99, 235, 0.38);\r\n}\r\n\r\n.pager {\r\n  margin-top: 10px;\r\n  padding: 8px 12px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 24px;\r\n  font-size: 13px;\r\n  color: #4b5563;\r\n}\r\n\r\n.pager-center {\r\n  min-width: 120px;\r\n  text-align: center;\r\n}\r\n\r\n.pager-btn {\r\n  padding: 4px 12px;\r\n  border-radius: 999px;\r\n  border: 1px solid #d1d5db;\r\n  background-color: #ffffff;\r\n  cursor: pointer;\r\n  font-size: 13px;\r\n  min-width: 72px;\r\n}\r\n\r\n.pager-btn:hover {\r\n  border-color: #2563eb;\r\n  color: #2563eb;\r\n}\r\n\r\n/* 禁用状态的样式 */\r\n.pager-btn-disabled,\r\n.pager-btn:disabled {\r\n  color: #9ca3af;\r\n  border-color: #e5e7eb;\r\n  background-color: #f9fafb;\r\n  cursor: not-allowed;\r\n}\r\n\r\n/* 只调“我的预约”那一页的间距 */\r\n.card-reservations .page-title {\r\n  margin-bottom: 15px;   /* 标题到表格的上间距的一半来自这里 */\r\n}\r\n\r\n.card-reservations .table-wrapper {\r\n  margin-top: 15px;      /* 标题到表格的另一半来自这里 */\r\n  margin-bottom: 15px;   /* 表格到底下分页的间距的一半 */\r\n}\r\n\r\n.card-reservations .pager {\r\n  margin-top: 15px;      /* 表格到底部分页的另一半 */\r\n}\r\n\r\n.badge-pending {\r\n  background-color: #e0f2fe;\r\n  color: #0369a1;\r\n}\r\n.badge-done {\r\n  background-color: #dcfce7;\r\n  color: #166534;\r\n}\r\n.badge-late {\r\n  background-color: #fef9c3;\r\n  color: #854d0e;\r\n}\r\n.badge-missed {\r\n  background-color: #fee2e2;\r\n  color: #b91c1c;\r\n}\r\n.badge-cancelled {\r\n  background-color: #e5e7eb;\r\n  color: #4b5563;\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}