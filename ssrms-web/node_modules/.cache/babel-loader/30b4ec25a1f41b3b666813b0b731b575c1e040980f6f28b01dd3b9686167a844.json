{"ast":null,"code":"import \"core-js/modules/esnext.json.parse.js\";\n// src/router/index.js\nimport { createRouter, createWebHistory } from 'vue-router';\nimport LoginPage from '@/components/LoginPage.vue';\nimport UserIndex from '@/components/UserIndex.vue'; // Â≠¶ÁîüÁ´Ø\nimport AdminIndex from '@/components/AdminIndex.vue'; // ÁÆ°ÁêÜÂëòÁ´Ø\n\nconst routes = [{\n  path: '/',\n  redirect: '/login'\n}, {\n  path: '/login',\n  name: 'Login',\n  component: LoginPage\n},\n// Â≠¶ÁîüÁ´ØÔºåÈúÄË¶ÅÁôªÂΩïÔºåËßíËâ≤=student\n{\n  path: '/user',\n  name: 'UserHome',\n  component: UserIndex,\n  meta: {\n    requiresAuth: true,\n    role: 'user' // Áî®Â≠óÁ¨¶‰∏≤ÊèèËø∞‰∏Ä‰∏ãËßíËâ≤ÔºåÊñπ‰æøÂà§Êñ≠\n  }\n},\n// ÁÆ°ÁêÜÂëòÁ´ØÔºåÈúÄË¶ÅÁôªÂΩïÔºåËßíËâ≤=admin\n{\n  path: '/admin',\n  name: 'AdminHome',\n  component: AdminIndex,\n  meta: {\n    requiresAuth: true,\n    role: 'admin'\n  }\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\n// üåü Ë∑ØÁî±ÂÆàÂç´ÔºöËøôÈáåÊòØÁúüÊ≠£Êã¶‰Ωè‚ÄúÁõ¥Êé•Êï≤Âú∞ÂùÄ‚ÄùÁöÑÂú∞Êñπ\nrouter.beforeEach((to, from, next) => {\n  const raw = localStorage.getItem('ssrmsUser');\n  const user = raw ? JSON.parse(raw) : null;\n\n  // 1ÔºâÈúÄË¶ÅÁôªÂΩïÁöÑÈ°µÈù¢\n  if (to.meta.requiresAuth) {\n    if (!user) {\n      // Ê≤°ÁôªÂΩïÔºåË∑≥ÂõûÁôªÂΩïÈ°µÔºåËøòÂèØ‰ª•Â∏¶‰∏Ä‰∏™ redirect ÂõûÊù•Áî®\n      return next({\n        path: '/login',\n        query: {\n          redirect: to.fullPath\n        }\n      });\n    }\n\n    // 2ÔºâÊåâËßíËâ≤Ê£ÄÊü•ÔºöroleId 0=ÁÆ°ÁêÜÂëò,1=Â≠¶Áîü\n    if (to.meta.role === 'admin' && user.roleId !== 0) {\n      return next('/login');\n    }\n    if (to.meta.role === 'user' && user.roleId !== 1) {\n      return next('/login');\n    }\n  }\n\n  // 3ÔºâÂ∑≤ÁªèÁôªÂΩï‰∫ÜÂèàÂéª /loginÔºåÂ∞±Áõ¥Êé•‰∏¢ÂõûÂØπÂ∫îÈ¶ñÈ°µ\n  if (to.path === '/login' && user) {\n    return next(user.roleId === 0 ? '/admin' : '/user');\n  }\n\n  // ÂÖ∂ÂÆÉÊÉÖÂÜµÊ≠£Â∏∏ÊîæË°å\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","LoginPage","UserIndex","AdminIndex","routes","path","redirect","name","component","meta","requiresAuth","role","router","history","beforeEach","to","from","next","raw","localStorage","getItem","user","JSON","parse","query","fullPath","roleId"],"sources":["D:/code/SpringBoot-Vue-SSRMS/ssrms-web/src/router/index.js"],"sourcesContent":["// src/router/index.js\r\nimport { createRouter, createWebHistory } from 'vue-router'\r\nimport LoginPage from '@/components/LoginPage.vue'\r\nimport UserIndex from '@/components/UserIndex.vue'      // Â≠¶ÁîüÁ´Ø\r\nimport AdminIndex from '@/components/AdminIndex.vue'    // ÁÆ°ÁêÜÂëòÁ´Ø\r\n\r\nconst routes = [\r\n    { path: '/', redirect: '/login' },\r\n\r\n    { path: '/login', name: 'Login', component: LoginPage },\r\n\r\n    // Â≠¶ÁîüÁ´ØÔºåÈúÄË¶ÅÁôªÂΩïÔºåËßíËâ≤=student\r\n    {\r\n        path: '/user',\r\n        name: 'UserHome',\r\n        component: UserIndex,\r\n        meta: {\r\n            requiresAuth: true,\r\n            role: 'user'   // Áî®Â≠óÁ¨¶‰∏≤ÊèèËø∞‰∏Ä‰∏ãËßíËâ≤ÔºåÊñπ‰æøÂà§Êñ≠\r\n        }\r\n    },\r\n\r\n    // ÁÆ°ÁêÜÂëòÁ´ØÔºåÈúÄË¶ÅÁôªÂΩïÔºåËßíËâ≤=admin\r\n    {\r\n        path: '/admin',\r\n        name: 'AdminHome',\r\n        component: AdminIndex,\r\n        meta: {\r\n            requiresAuth: true,\r\n            role: 'admin'\r\n        }\r\n    }\r\n]\r\n\r\nconst router = createRouter({\r\n    history: createWebHistory(),\r\n    routes\r\n})\r\n\r\n// üåü Ë∑ØÁî±ÂÆàÂç´ÔºöËøôÈáåÊòØÁúüÊ≠£Êã¶‰Ωè‚ÄúÁõ¥Êé•Êï≤Âú∞ÂùÄ‚ÄùÁöÑÂú∞Êñπ\r\nrouter.beforeEach((to, from, next) => {\r\n    const raw = localStorage.getItem('ssrmsUser')\r\n    const user = raw ? JSON.parse(raw) : null\r\n\r\n    // 1ÔºâÈúÄË¶ÅÁôªÂΩïÁöÑÈ°µÈù¢\r\n    if (to.meta.requiresAuth) {\r\n        if (!user) {\r\n            // Ê≤°ÁôªÂΩïÔºåË∑≥ÂõûÁôªÂΩïÈ°µÔºåËøòÂèØ‰ª•Â∏¶‰∏Ä‰∏™ redirect ÂõûÊù•Áî®\r\n            return next({\r\n                path: '/login',\r\n                query: { redirect: to.fullPath }\r\n            })\r\n        }\r\n\r\n        // 2ÔºâÊåâËßíËâ≤Ê£ÄÊü•ÔºöroleId 0=ÁÆ°ÁêÜÂëò,1=Â≠¶Áîü\r\n        if (to.meta.role === 'admin' && user.roleId !== 0) {\r\n            return next('/login')\r\n        }\r\n        if (to.meta.role === 'user' && user.roleId !== 1) {\r\n            return next('/login')\r\n        }\r\n    }\r\n\r\n    // 3ÔºâÂ∑≤ÁªèÁôªÂΩï‰∫ÜÂèàÂéª /loginÔºåÂ∞±Áõ¥Êé•‰∏¢ÂõûÂØπÂ∫îÈ¶ñÈ°µ\r\n    if (to.path === '/login' && user) {\r\n        return next(user.roleId === 0 ? '/admin' : '/user')\r\n    }\r\n\r\n    // ÂÖ∂ÂÆÉÊÉÖÂÜµÊ≠£Â∏∏ÊîæË°å\r\n    next()\r\n})\r\n\r\nexport default router"],"mappings":";AAAA;AACA,SAASA,YAAY,EAAEC,gBAAgB,QAAQ,YAAY;AAC3D,OAAOC,SAAS,MAAM,4BAA4B;AAClD,OAAOC,SAAS,MAAM,4BAA4B,EAAM;AACxD,OAAOC,UAAU,MAAM,6BAA6B,EAAI;;AAExD,MAAMC,MAAM,GAAG,CACX;EAAEC,IAAI,EAAE,GAAG;EAAEC,QAAQ,EAAE;AAAS,CAAC,EAEjC;EAAED,IAAI,EAAE,QAAQ;EAAEE,IAAI,EAAE,OAAO;EAAEC,SAAS,EAAEP;AAAU,CAAC;AAEvD;AACA;EACII,IAAI,EAAE,OAAO;EACbE,IAAI,EAAE,UAAU;EAChBC,SAAS,EAAEN,SAAS;EACpBO,IAAI,EAAE;IACFC,YAAY,EAAE,IAAI;IAClBC,IAAI,EAAE,MAAM,CAAG;EACnB;AACJ,CAAC;AAED;AACA;EACIN,IAAI,EAAE,QAAQ;EACdE,IAAI,EAAE,WAAW;EACjBC,SAAS,EAAEL,UAAU;EACrBM,IAAI,EAAE;IACFC,YAAY,EAAE,IAAI;IAClBC,IAAI,EAAE;EACV;AACJ,CAAC,CACJ;AAED,MAAMC,MAAM,GAAGb,YAAY,CAAC;EACxBc,OAAO,EAAEb,gBAAgB,CAAC,CAAC;EAC3BI;AACJ,CAAC,CAAC;;AAEF;AACAQ,MAAM,CAACE,UAAU,CAAC,CAACC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EAClC,MAAMC,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC7C,MAAMC,IAAI,GAAGH,GAAG,GAAGI,IAAI,CAACC,KAAK,CAACL,GAAG,CAAC,GAAG,IAAI;;EAEzC;EACA,IAAIH,EAAE,CAACN,IAAI,CAACC,YAAY,EAAE;IACtB,IAAI,CAACW,IAAI,EAAE;MACP;MACA,OAAOJ,IAAI,CAAC;QACRZ,IAAI,EAAE,QAAQ;QACdmB,KAAK,EAAE;UAAElB,QAAQ,EAAES,EAAE,CAACU;QAAS;MACnC,CAAC,CAAC;IACN;;IAEA;IACA,IAAIV,EAAE,CAACN,IAAI,CAACE,IAAI,KAAK,OAAO,IAAIU,IAAI,CAACK,MAAM,KAAK,CAAC,EAAE;MAC/C,OAAOT,IAAI,CAAC,QAAQ,CAAC;IACzB;IACA,IAAIF,EAAE,CAACN,IAAI,CAACE,IAAI,KAAK,MAAM,IAAIU,IAAI,CAACK,MAAM,KAAK,CAAC,EAAE;MAC9C,OAAOT,IAAI,CAAC,QAAQ,CAAC;IACzB;EACJ;;EAEA;EACA,IAAIF,EAAE,CAACV,IAAI,KAAK,QAAQ,IAAIgB,IAAI,EAAE;IAC9B,OAAOJ,IAAI,CAACI,IAAI,CAACK,MAAM,KAAK,CAAC,GAAG,QAAQ,GAAG,OAAO,CAAC;EACvD;;EAEA;EACAT,IAAI,CAAC,CAAC;AACV,CAAC,CAAC;AAEF,eAAeL,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}