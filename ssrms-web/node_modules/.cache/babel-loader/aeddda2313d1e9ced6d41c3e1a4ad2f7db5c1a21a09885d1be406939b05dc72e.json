{"ast":null,"code":"import { ref, unref } from 'vue';\nimport { useEventListener } from '@vueuse/core';\nimport { cAF, rAF } from '../../../../utils/raf.mjs';\nconst useGridTouch = (windowRef, states, scrollTo, estimatedTotalWidth, estimatedTotalHeight, parsedWidth, parsedHeight) => {\n  const touchStartX = ref(0);\n  const touchStartY = ref(0);\n  let frameHandle;\n  let deltaX = 0;\n  let deltaY = 0;\n  const handleTouchStart = event => {\n    cAF(frameHandle);\n    touchStartX.value = event.touches[0].clientX;\n    touchStartY.value = event.touches[0].clientY;\n    deltaX = 0;\n    deltaY = 0;\n  };\n  const handleTouchMove = event => {\n    event.preventDefault();\n    cAF(frameHandle);\n    deltaX += touchStartX.value - event.touches[0].clientX;\n    deltaY += touchStartY.value - event.touches[0].clientY;\n    touchStartX.value = event.touches[0].clientX;\n    touchStartY.value = event.touches[0].clientY;\n    frameHandle = rAF(() => {\n      const maxScrollLeft = estimatedTotalWidth.value - unref(parsedWidth);\n      const maxScrollTop = estimatedTotalHeight.value - unref(parsedHeight);\n      const safeScrollLeft = Math.min(states.value.scrollLeft + deltaX, maxScrollLeft);\n      const safeScrollTop = Math.min(states.value.scrollTop + deltaY, maxScrollTop);\n      scrollTo({\n        scrollLeft: safeScrollLeft,\n        scrollTop: safeScrollTop\n      });\n      deltaX = 0;\n      deltaY = 0;\n    });\n  };\n  useEventListener(windowRef, \"touchstart\", handleTouchStart, {\n    passive: true\n  });\n  useEventListener(windowRef, \"touchmove\", handleTouchMove, {\n    passive: false\n  });\n  return {\n    touchStartX,\n    touchStartY,\n    handleTouchStart,\n    handleTouchMove\n  };\n};\nexport { useGridTouch };","map":{"version":3,"names":["useGridTouch","windowRef","states","scrollTo","estimatedTotalWidth","estimatedTotalHeight","parsedWidth","parsedHeight","touchStartX","ref","touchStartY","frameHandle","deltaX","deltaY","handleTouchStart","event","cAF","value","touches","clientX","clientY","handleTouchMove","preventDefault","rAF","maxScrollLeft","unref","maxScrollTop","safeScrollLeft","Math","min","scrollLeft","safeScrollTop","scrollTop","useEventListener","passive"],"sources":["../../../../../../../packages/components/virtual-list/src/hooks/use-grid-touch.ts"],"sourcesContent":["import { ref, unref } from 'vue'\nimport { useEventListener } from '@vueuse/core'\nimport { cAF, rAF } from '@element-plus/utils'\n\nimport type { ComputedRef, Ref } from 'vue'\nimport type { GridScrollOptions, GridStates } from '../types'\n\nexport const useGridTouch = (\n  windowRef: Ref<HTMLElement | undefined>,\n  states: Ref<GridStates>,\n  scrollTo: (scrollOptions: GridScrollOptions) => void,\n  estimatedTotalWidth: ComputedRef<number>,\n  estimatedTotalHeight: ComputedRef<number>,\n  parsedWidth: ComputedRef<number>,\n  parsedHeight: ComputedRef<number>\n) => {\n  const touchStartX = ref(0)\n  const touchStartY = ref(0)\n  let frameHandle: number | undefined\n  let deltaX = 0\n  let deltaY = 0\n\n  const handleTouchStart = (event: TouchEvent) => {\n    cAF(frameHandle!)\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n    deltaX = 0\n    deltaY = 0\n  }\n\n  const handleTouchMove = (event: TouchEvent) => {\n    event.preventDefault()\n    cAF(frameHandle!)\n\n    deltaX += touchStartX.value - event.touches[0].clientX\n    deltaY += touchStartY.value - event.touches[0].clientY\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n\n    frameHandle = rAF(() => {\n      const maxScrollLeft = estimatedTotalWidth.value - unref(parsedWidth)\n      const maxScrollTop = estimatedTotalHeight.value - unref(parsedHeight)\n\n      const safeScrollLeft = Math.min(\n        states.value.scrollLeft + deltaX,\n        maxScrollLeft\n      )\n      const safeScrollTop = Math.min(\n        states.value.scrollTop + deltaY,\n        maxScrollTop\n      )\n\n      scrollTo({\n        scrollLeft: safeScrollLeft,\n        scrollTop: safeScrollTop,\n      })\n\n      deltaX = 0\n      deltaY = 0\n    })\n  }\n\n  useEventListener(windowRef, 'touchstart', handleTouchStart, {\n    passive: true,\n  })\n  useEventListener(windowRef, 'touchmove', handleTouchMove, {\n    passive: false,\n  })\n\n  return {\n    touchStartX,\n    touchStartY,\n    handleTouchStart,\n    handleTouchMove,\n  }\n}\n"],"mappings":";;;AAGY,MAACA,YAAY,GAAGA,CAACC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,mBAAmB,EAAEC,oBAAoB,EAAEC,WAAW,EAAEC,YAAY,KAAK;EACjI,MAAMC,WAAW,GAAGC,GAAG,CAAC,CAAC,CAAC;EAC1B,MAAMC,WAAW,GAAGD,GAAG,CAAC,CAAC,CAAC;EAC1B,IAAIE,WAAW;EACf,IAAIC,MAAM,GAAG,CAAC;EACd,IAAIC,MAAM,GAAG,CAAC;EACd,MAAMC,gBAAgB,GAAIC,KAAK,IAAK;IAClCC,GAAG,CAACL,WAAW,CAAC;IAChBH,WAAW,CAACS,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO;IAC5CT,WAAW,CAACO,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO;IAC5CR,MAAM,GAAG,CAAC;IACVC,MAAM,GAAG,CAAC;EACd,CAAG;EACD,MAAMQ,eAAe,GAAIN,KAAK,IAAK;IACjCA,KAAK,CAACO,cAAc,EAAE;IACtBN,GAAG,CAACL,WAAW,CAAC;IAChBC,MAAM,IAAIJ,WAAW,CAACS,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO;IACtDN,MAAM,IAAIH,WAAW,CAACO,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO;IACtDZ,WAAW,CAACS,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO;IAC5CT,WAAW,CAACO,KAAK,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO;IAC5CT,WAAW,GAAGY,GAAG,CAAC,MAAM;MACtB,MAAMC,aAAa,GAAGpB,mBAAmB,CAACa,KAAK,GAAGQ,KAAK,CAACnB,WAAW,CAAC;MACpE,MAAMoB,YAAY,GAAGrB,oBAAoB,CAACY,KAAK,GAAGQ,KAAK,CAAClB,YAAY,CAAC;MACrE,MAAMoB,cAAc,GAAGC,IAAI,CAACC,GAAG,CAAC3B,MAAM,CAACe,KAAK,CAACa,UAAU,GAAGlB,MAAM,EAAEY,aAAa,CAAC;MAChF,MAAMO,aAAa,GAAGH,IAAI,CAACC,GAAG,CAAC3B,MAAM,CAACe,KAAK,CAACe,SAAS,GAAGnB,MAAM,EAAEa,YAAY,CAAC;MAC7EvB,QAAQ,CAAC;QACP2B,UAAU,EAAEH,cAAc;QAC1BK,SAAS,EAAED;MACnB,CAAO,CAAC;MACFnB,MAAM,GAAG,CAAC;MACVC,MAAM,GAAG,CAAC;IAChB,CAAK,CAAC;EACN,CAAG;EACDoB,gBAAgB,CAAChC,SAAS,EAAE,YAAY,EAAEa,gBAAgB,EAAE;IAC1DoB,OAAO,EAAE;EACb,CAAG,CAAC;EACFD,gBAAgB,CAAChC,SAAS,EAAE,WAAW,EAAEoB,eAAe,EAAE;IACxDa,OAAO,EAAE;EACb,CAAG,CAAC;EACF,OAAO;IACL1B,WAAW;IACXE,WAAW;IACXI,gBAAgB;IAChBO;EACJ,CAAG;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}