{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { computed, ref, watch, onBeforeUnmount } from 'vue';\nimport { useWindowSize, clamp, useEventListener } from '@vueuse/core';\nimport { addUnit } from '../../../../utils/dom/style.mjs';\nfunction useResizable(props, target, emit) {\n  const {\n    width,\n    height\n  } = useWindowSize();\n  const isHorizontal = computed(() => [\"ltr\", \"rtl\"].includes(props.direction));\n  const sign = computed(() => [\"ltr\", \"ttb\"].includes(props.direction) ? 1 : -1);\n  const windowSize = computed(() => isHorizontal.value ? width.value : height.value);\n  const getSize = computed(() => {\n    return clamp(startSize.value + sign.value * offset.value, 4, windowSize.value);\n  });\n  const startSize = ref(0);\n  const offset = ref(0);\n  const isResizing = ref(false);\n  const hasStartedDragging = ref(false);\n  let startPos = [];\n  let cleanups = [];\n  const getActualSize = () => {\n    var _a;\n    const drawerEl = (_a = target.value) == null ? void 0 : _a.closest('[aria-modal=\"true\"]');\n    if (drawerEl) {\n      return isHorizontal.value ? drawerEl.offsetWidth : drawerEl.offsetHeight;\n    }\n    return 100;\n  };\n  watch(() => [props.size, props.resizable], () => {\n    hasStartedDragging.value = false;\n    startSize.value = 0;\n    offset.value = 0;\n    onMouseUp();\n  });\n  const onMousedown = e => {\n    if (!props.resizable) return;\n    if (!hasStartedDragging.value) {\n      startSize.value = getActualSize();\n      hasStartedDragging.value = true;\n    }\n    startPos = [e.pageX, e.pageY];\n    isResizing.value = true;\n    emit(\"resize-start\", e, startSize.value);\n    cleanups.push(useEventListener(window, \"mouseup\", onMouseUp), useEventListener(window, \"mousemove\", onMouseMove));\n  };\n  const onMouseMove = e => {\n    const {\n      pageX,\n      pageY\n    } = e;\n    const offsetX = pageX - startPos[0];\n    const offsetY = pageY - startPos[1];\n    offset.value = isHorizontal.value ? offsetX : offsetY;\n    emit(\"resize\", e, getSize.value);\n  };\n  const onMouseUp = e => {\n    if (!isResizing.value) return;\n    startPos = [];\n    startSize.value = getSize.value;\n    offset.value = 0;\n    isResizing.value = false;\n    cleanups.forEach(cleanup2 => cleanup2 == null ? void 0 : cleanup2());\n    cleanups = [];\n    if (e) {\n      emit(\"resize-end\", e, startSize.value);\n    }\n  };\n  const cleanup = useEventListener(target, \"mousedown\", onMousedown);\n  onBeforeUnmount(() => {\n    cleanup();\n    onMouseUp();\n  });\n  return {\n    size: computed(() => {\n      return hasStartedDragging.value ? `${getSize.value}px` : addUnit(props.size);\n    }),\n    isResizing,\n    isHorizontal\n  };\n}\nexport { useResizable };","map":{"version":3,"names":["useResizable","props","target","emit","width","height","useWindowSize","isHorizontal","computed","includes","direction","sign","windowSize","value","getSize","clamp","startSize","offset","ref","isResizing","hasStartedDragging","startPos","cleanups","getActualSize","_a","drawerEl","closest","offsetWidth","offsetHeight","watch","size","resizable","onMouseUp","onMousedown","e","pageX","pageY","push","useEventListener","window","onMouseMove","offsetX","offsetY","forEach","cleanup2","cleanup","onBeforeUnmount","addUnit"],"sources":["../../../../../../../packages/components/drawer/src/composables/useResizable.ts"],"sourcesContent":["import { computed, onBeforeUnmount, ref, watch } from 'vue'\nimport { addUnit } from '@element-plus/utils'\nimport { clamp, useEventListener, useWindowSize } from '@vueuse/core'\n\nimport type { Ref, SetupContext } from 'vue'\nimport type { DrawerEmits, DrawerProps } from '../drawer'\n\nexport function useResizable(\n  props: DrawerProps,\n  target: Ref<HTMLElement | undefined>,\n  emit: SetupContext<DrawerEmits>['emit']\n) {\n  const { width, height } = useWindowSize()\n\n  const isHorizontal = computed(() => ['ltr', 'rtl'].includes(props.direction))\n  const sign = computed(() =>\n    ['ltr', 'ttb'].includes(props.direction) ? 1 : -1\n  )\n  const windowSize = computed(() =>\n    isHorizontal.value ? width.value : height.value\n  )\n  const getSize = computed(() => {\n    return clamp(\n      startSize.value + sign.value * offset.value,\n      4,\n      windowSize.value\n    )\n  })\n\n  const startSize = ref(0)\n  const offset = ref(0)\n  const isResizing = ref(false)\n  const hasStartedDragging = ref(false)\n  let startPos: number[] = []\n  let cleanups: (() => void)[] = []\n\n  const getActualSize = () => {\n    const drawerEl = target.value?.closest('[aria-modal=\"true\"]') as HTMLElement\n    if (drawerEl) {\n      return isHorizontal.value ? drawerEl.offsetWidth : drawerEl.offsetHeight\n    }\n    return 100\n  }\n\n  watch(\n    () => [props.size, props.resizable] as const,\n    () => {\n      hasStartedDragging.value = false\n      startSize.value = 0\n      offset.value = 0\n      onMouseUp()\n    }\n  )\n\n  const onMousedown = (e: MouseEvent) => {\n    if (!props.resizable) return\n\n    if (!hasStartedDragging.value) {\n      startSize.value = getActualSize()\n      hasStartedDragging.value = true\n    }\n\n    startPos = [e.pageX, e.pageY]\n    isResizing.value = true\n    emit('resize-start', e, startSize.value)\n    cleanups.push(\n      useEventListener(window, 'mouseup', onMouseUp),\n      useEventListener(window, 'mousemove', onMouseMove)\n    )\n  }\n\n  const onMouseMove = (e: MouseEvent) => {\n    const { pageX, pageY } = e\n    const offsetX = pageX - startPos[0]\n    const offsetY = pageY - startPos[1]\n    offset.value = isHorizontal.value ? offsetX : offsetY\n    emit('resize', e, getSize.value)\n  }\n\n  const onMouseUp = (e?: MouseEvent) => {\n    // premature interruption\n    // avoid triggering meaningless execution due to watch size/resizable constraints.\n    if (!isResizing.value) return\n\n    startPos = []\n    startSize.value = getSize.value\n    offset.value = 0\n    isResizing.value = false\n    cleanups.forEach((cleanup) => cleanup?.())\n    cleanups = []\n    if (e) {\n      emit('resize-end', e, startSize.value)\n    }\n  }\n\n  const cleanup = useEventListener(target, 'mousedown', onMousedown)\n\n  onBeforeUnmount(() => {\n    cleanup()\n    onMouseUp()\n  })\n\n  return {\n    size: computed(() => {\n      return hasStartedDragging.value\n        ? `${getSize.value}px`\n        : addUnit(props.size)\n    }),\n    isResizing,\n    isHorizontal,\n  }\n}\n"],"mappings":";;;;;;AAGO,SAASA,YAAYA,CAACC,KAAK,EAAEC,MAAM,EAAEC,IAAI,EAAE;EAChD,MAAM;IAAEC,KAAK;IAAEC;EAAM,CAAE,GAAGC,aAAa,EAAE;EACzC,MAAMC,YAAY,GAAGC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,CAACC,QAAQ,CAACR,KAAK,CAACS,SAAS,CAAC,CAAC;EAC7E,MAAMC,IAAI,GAAGH,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,CAACC,QAAQ,CAACR,KAAK,CAACS,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;EAC9E,MAAME,UAAU,GAAGJ,QAAQ,CAAC,MAAMD,YAAY,CAACM,KAAK,GAAGT,KAAK,CAACS,KAAK,GAAGR,MAAM,CAACQ,KAAK,CAAC;EAClF,MAAMC,OAAO,GAAGN,QAAQ,CAAC,MAAM;IAC7B,OAAOO,KAAK,CAACC,SAAS,CAACH,KAAK,GAAGF,IAAI,CAACE,KAAK,GAAGI,MAAM,CAACJ,KAAK,EAAE,CAAC,EAAED,UAAU,CAACC,KAAK,CAAC;EAClF,CAAG,CAAC;EACF,MAAMG,SAAS,GAAGE,GAAG,CAAC,CAAC,CAAC;EACxB,MAAMD,MAAM,GAAGC,GAAG,CAAC,CAAC,CAAC;EACrB,MAAMC,UAAU,GAAGD,GAAG,CAAC,KAAK,CAAC;EAC7B,MAAME,kBAAkB,GAAGF,GAAG,CAAC,KAAK,CAAC;EACrC,IAAIG,QAAQ,GAAG,EAAE;EACjB,IAAIC,QAAQ,GAAG,EAAE;EACjB,MAAMC,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAIC,EAAE;IACN,MAAMC,QAAQ,GAAG,CAACD,EAAE,GAAGtB,MAAM,CAACW,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGW,EAAE,CAACE,OAAO,CAAC,qBAAqB,CAAC;IACzF,IAAID,QAAQ,EAAE;MACZ,OAAOlB,YAAY,CAACM,KAAK,GAAGY,QAAQ,CAACE,WAAW,GAAGF,QAAQ,CAACG,YAAY;IAC9E;IACI,OAAO,GAAG;EACd,CAAG;EACDC,KAAK,CAAC,MAAM,CAAC5B,KAAK,CAAC6B,IAAI,EAAE7B,KAAK,CAAC8B,SAAS,CAAC,EAAE,MAAM;IAC/CX,kBAAkB,CAACP,KAAK,GAAG,KAAK;IAChCG,SAAS,CAACH,KAAK,GAAG,CAAC;IACnBI,MAAM,CAACJ,KAAK,GAAG,CAAC;IAChBmB,SAAS,EAAE;EACf,CAAG,CAAC;EACF,MAAMC,WAAW,GAAIC,CAAC,IAAK;IACzB,IAAI,CAACjC,KAAK,CAAC8B,SAAS,EAClB;IACF,IAAI,CAACX,kBAAkB,CAACP,KAAK,EAAE;MAC7BG,SAAS,CAACH,KAAK,GAAGU,aAAa,EAAE;MACjCH,kBAAkB,CAACP,KAAK,GAAG,IAAI;IACrC;IACIQ,QAAQ,GAAG,CAACa,CAAC,CAACC,KAAK,EAAED,CAAC,CAACE,KAAK,CAAC;IAC7BjB,UAAU,CAACN,KAAK,GAAG,IAAI;IACvBV,IAAI,CAAC,cAAc,EAAE+B,CAAC,EAAElB,SAAS,CAACH,KAAK,CAAC;IACxCS,QAAQ,CAACe,IAAI,CAACC,gBAAgB,CAACC,MAAM,EAAE,SAAS,EAAEP,SAAS,CAAC,EAAEM,gBAAgB,CAACC,MAAM,EAAE,WAAW,EAAEC,WAAW,CAAC,CAAC;EACrH,CAAG;EACD,MAAMA,WAAW,GAAIN,CAAC,IAAK;IACzB,MAAM;MAAEC,KAAK;MAAEC;IAAK,CAAE,GAAGF,CAAC;IAC1B,MAAMO,OAAO,GAAGN,KAAK,GAAGd,QAAQ,CAAC,CAAC,CAAC;IACnC,MAAMqB,OAAO,GAAGN,KAAK,GAAGf,QAAQ,CAAC,CAAC,CAAC;IACnCJ,MAAM,CAACJ,KAAK,GAAGN,YAAY,CAACM,KAAK,GAAG4B,OAAO,GAAGC,OAAO;IACrDvC,IAAI,CAAC,QAAQ,EAAE+B,CAAC,EAAEpB,OAAO,CAACD,KAAK,CAAC;EACpC,CAAG;EACD,MAAMmB,SAAS,GAAIE,CAAC,IAAK;IACvB,IAAI,CAACf,UAAU,CAACN,KAAK,EACnB;IACFQ,QAAQ,GAAG,EAAE;IACbL,SAAS,CAACH,KAAK,GAAGC,OAAO,CAACD,KAAK;IAC/BI,MAAM,CAACJ,KAAK,GAAG,CAAC;IAChBM,UAAU,CAACN,KAAK,GAAG,KAAK;IACxBS,QAAQ,CAACqB,OAAO,CAAEC,QAAQ,IAAKA,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,QAAQ,EAAE,CAAC;IACtEtB,QAAQ,GAAG,EAAE;IACb,IAAIY,CAAC,EAAE;MACL/B,IAAI,CAAC,YAAY,EAAE+B,CAAC,EAAElB,SAAS,CAACH,KAAK,CAAC;IAC5C;EACA,CAAG;EACD,MAAMgC,OAAO,GAAGP,gBAAgB,CAACpC,MAAM,EAAE,WAAW,EAAE+B,WAAW,CAAC;EAClEa,eAAe,CAAC,MAAM;IACpBD,OAAO,EAAE;IACTb,SAAS,EAAE;EACf,CAAG,CAAC;EACF,OAAO;IACLF,IAAI,EAAEtB,QAAQ,CAAC,MAAM;MACnB,OAAOY,kBAAkB,CAACP,KAAK,GAAG,GAAGC,OAAO,CAACD,KAAK,IAAI,GAAGkC,OAAO,CAAC9C,KAAK,CAAC6B,IAAI,CAAC;IAClF,CAAK,CAAC;IACFX,UAAU;IACVZ;EACJ,CAAG;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}